<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  HGeometry.Plane.LowerEnvelope.Connected.Type</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- A Representation of the Lower envelope of planes in Adjacency-list</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- form.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HGeometry.Plane.LowerEnvelope.Connected.Type</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier">LowerEnvelope'</span></a></span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier">LowerEnvelope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#theUnboundedVertex"><span class="hs-identifier">theUnboundedVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#boundedVertices"><span class="hs-identifier">boundedVertices</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#traverseLowerEnvelope"><span class="hs-identifier">traverseLowerEnvelope</span></a></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#singleton"><span class="hs-identifier">singleton</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#BoundedVertex"><span class="hs-identifier">BoundedVertex</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#BoundedVertexF"><span class="hs-identifier">BoundedVertexF</span></a></span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#Vertex"><span class="hs-identifier">Vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#location"><span class="hs-identifier">location</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#definers"><span class="hs-identifier">definers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#location2"><span class="hs-identifier">location2</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier">UnboundedVertex</span></a></span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier">UnboundedVertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#unboundedVertexId"><span class="hs-identifier">unboundedVertexId</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#HasUnboundedEdges"><span class="hs-identifier">HasUnboundedEdges</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeGeometry"><span class="hs-identifier">EdgeGeometry</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#projectedEdgeGeometries"><span class="hs-identifier">projectedEdgeGeometries</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#projectedEdgeGeometry"><span class="hs-identifier">projectedEdgeGeometry</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#outgoingUnboundedEdge"><span class="hs-identifier">outgoingUnboundedEdge</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#edgeIntersectionLine"><span class="hs-identifier">edgeIntersectionLine</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#intersectionLine%27"><span class="hs-identifier">intersectionLine'</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#intersectionLineWithDefiners"><span class="hs-identifier">intersectionLineWithDefiners</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier">EdgeDefiners</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable1</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Apply.html"><span class="hs-identifier">Data.Functor.Apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#Apply"><span class="hs-identifier">Apply</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#%3C.%2A%3E"><span class="hs-operator">(&lt;.*&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Apply.html"><span class="hs-identifier">Data.Functor.Apply</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Apply</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Semigroup.Traversable.html"><span class="hs-identifier">Data.Semigroup.Traversable</span></a></span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#traverse1Maybe"><span class="hs-identifier">traverse1Maybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/vector-0.13.1.0-29d63c43381c98813efe04876e9ecdc0f12f411fd574c0bcbf808e7a8274dea3/share/doc/html/src/Data.Vector.html"><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Box</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html"><span class="hs-identifier">HGeometry.Combinatorial.Util</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Sort.html"><span class="hs-identifier">HGeometry.Foldable.Sort</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Util.html"><span class="hs-identifier">HGeometry.Foldable.Util</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.HalfLine</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.HyperPlane.Class</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.HyperPlane.NonVertical</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Line</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Line.General</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.LineSegment</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html"><span class="hs-identifier">HGeometry.Plane.LowerEnvelope.Type</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.VertexForm.html"><span class="hs-identifier">HGeometry.Plane.LowerEnvelope.VertexForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.VertexForm.html#intersectionLine"><span class="hs-identifier">intersectionLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.VertexForm.html"><span class="hs-identifier">HGeometry.Plane.LowerEnvelope.VertexForm</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">VertexForm</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Properties</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Vector</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Vector.NonEmpty.Util.html"><span class="hs-identifier">HGeometry.Vector.NonEmpty.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.html"><span class="hs-identifier">Hiraffe.Graph</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/witherable-0.5-c5edceb70d9a4ac9829d3530022ba57205cc54de81b5a712afa5707c9d26bdde/share/doc/html/src/Witherable.html"><span class="hs-identifier">Witherable</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-73"></span><span class="annot"><span class="hs-comment">-- * Data type defining a connected lower envelope</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | A connected lower envelope in adjacencylist form.</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- invariant: there is always at least one bounded vertex.</span><span>
</span><span id="line-78"></span><span class="hs-keyword">data</span><span> </span><span id="LowerEnvelope%27"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-var">LowerEnvelope'</span></a></span></span><span> </span><span id="local-6989586621679462457"><span class="annot"><a href="#local-6989586621679462457"><span class="hs-identifier hs-type">plane</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>  </span><span id="LowerEnvelope"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier hs-type">UnboundedVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462457"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#BoundedVertex"><span class="hs-identifier hs-type">BoundedVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462457"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span id="local-6989586621679462390"><span id="local-6989586621679462994"><span id="local-6989586621679463003"><span id="local-6989586621679463007"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679462390"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679462390"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462390"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-82"></span><span id="local-6989586621679462398"><span id="local-6989586621679463017"><span id="local-6989586621679463024"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679462398"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679462398"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462398"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><span class="hs-identifier hs-var">NumType</span></span></span><span>   </span><span id="local-6989586621679463032"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463032"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679463032"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><span class="hs-identifier hs-var">Dimension</span></span></span><span> </span><span id="local-6989586621679463033"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463033"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679462409"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679462409"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679462409"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsBoxable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462409"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-comment">-- ^ the bounding box contains all bounded vertices</span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679463078"><span class="annot"><span class="annottext">boundingBox :: forall (d :: Nat) r.
(d ~ Dimension (LowerEnvelope' plane),
 r ~ NumType (LowerEnvelope' plane), Ord r) =&gt;
LowerEnvelope' plane -&gt; Box (Point d r)
</span><a href="#local-6989586621679463078"><span class="hs-identifier hs-var hs-var hs-var hs-var">boundingBox</span></a></span></span><span> </span><span id="local-6989586621679463080"><span class="annot"><span class="annottext">LowerEnvelope' plane
</span><a href="#local-6989586621679463080"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Point 3 r) -&gt; Box (Point d r)
forall (d :: Nat) r.
(d ~ Dimension (NonEmpty (Point 3 r)),
 r ~ NumType (NonEmpty (Point 3 r)), Ord r) =&gt;
NonEmpty (Point 3 r) -&gt; Box (Point d r)
forall g (d :: Nat) r.
(IsBoxable g, d ~ Dimension g, r ~ NumType g, Ord r) =&gt;
g -&gt; Box (Point d r)
</span><span class="hs-identifier hs-var">boundingBox</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Point 3 r) -&gt; Box (Point d r))
-&gt; ([Point 3 r] -&gt; NonEmpty (Point 3 r))
-&gt; [Point 3 r]
-&gt; Box (Point d r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 3 r] -&gt; NonEmpty (Point 3 r)
forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Point 3 r] -&gt; Box (Point d r)) -&gt; [Point 3 r] -&gt; Box (Point d r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LowerEnvelope' plane
</span><a href="#local-6989586621679463080"><span class="hs-identifier hs-var">env</span></a></span><span class="annot"><span class="annottext">LowerEnvelope' plane
-&gt; Getting (Endo [Point 3 r]) (LowerEnvelope' plane) (Point 3 r)
-&gt; [Point 3 r]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">(Seq (BoundedVertex plane)
 -&gt; Const (Endo [Point 3 r]) (Seq (BoundedVertex plane)))
-&gt; LowerEnvelope' plane
-&gt; Const (Endo [Point 3 r]) (LowerEnvelope' plane)
forall plane (f :: * -&gt; *).
Functor f =&gt;
(Seq (BoundedVertex plane) -&gt; f (Seq (BoundedVertex plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#boundedVertices"><span class="hs-identifier hs-var">boundedVertices</span></a></span><span class="annot"><span class="annottext">((Seq (BoundedVertex plane)
  -&gt; Const (Endo [Point 3 r]) (Seq (BoundedVertex plane)))
 -&gt; LowerEnvelope' plane
 -&gt; Const (Endo [Point 3 r]) (LowerEnvelope' plane))
-&gt; ((Point 3 r -&gt; Const (Endo [Point 3 r]) (Point 3 r))
    -&gt; Seq (BoundedVertex plane)
    -&gt; Const (Endo [Point 3 r]) (Seq (BoundedVertex plane)))
-&gt; Getting (Endo [Point 3 r]) (LowerEnvelope' plane) (Point 3 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(BoundedVertex plane
 -&gt; Const (Endo [Point 3 r]) (BoundedVertex plane))
-&gt; Seq (BoundedVertex plane)
-&gt; Const (Endo [Point 3 r]) (Seq (BoundedVertex plane))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Seq a -&gt; f (Seq b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">((BoundedVertex plane
  -&gt; Const (Endo [Point 3 r]) (BoundedVertex plane))
 -&gt; Seq (BoundedVertex plane)
 -&gt; Const (Endo [Point 3 r]) (Seq (BoundedVertex plane)))
-&gt; ((Point 3 r -&gt; Const (Endo [Point 3 r]) (Point 3 r))
    -&gt; BoundedVertex plane
    -&gt; Const (Endo [Point 3 r]) (BoundedVertex plane))
-&gt; (Point 3 r -&gt; Const (Endo [Point 3 r]) (Point 3 r))
-&gt; Seq (BoundedVertex plane)
-&gt; Const (Endo [Point 3 r]) (Seq (BoundedVertex plane))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 3 r -&gt; Const (Endo [Point 3 r]) (Point 3 r))
-&gt; BoundedVertex plane
-&gt; Const (Endo [Point 3 r]) (BoundedVertex plane)
forall plane r (f :: * -&gt; *).
(NumType plane ~ r) =&gt;
Lens' (BoundedVertexF f plane) (Point 3 r)
Lens' (BoundedVertex plane) (Point 3 r)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#location"><span class="hs-identifier hs-var">location</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">-- the fromList is safe since there is alwasy at least one vertex</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | Traversal of the planes in the lower envelope. Since we need an Ord constraint we</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- can't make LowerEnvelope' an instance of Traversable.</span><span>
</span><span id="line-94"></span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- Be aware that this may destroy some of the invariants. So use this function with care.</span><span>
</span><span id="line-96"></span><span id="local-6989586621679462450"><span id="local-6989586621679462451"><span id="local-6989586621679462452"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#traverseLowerEnvelope"><span class="hs-identifier hs-type">traverseLowerEnvelope</span></a></span><span>                         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679462450"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679462451"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679462452"><span class="hs-identifier hs-type">plane'</span></a></span><span>
</span><span id="line-97"></span><span>                                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462452"><span class="hs-identifier hs-type">plane'</span></a></span><span>
</span><span id="line-98"></span><span>                                                 </span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>                                              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679462451"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462450"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462452"><span class="hs-identifier hs-type">plane'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>                                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462451"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-101"></span><span>                                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462450"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462452"><span class="hs-identifier hs-type">plane'</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-102"></span><span id="traverseLowerEnvelope"><span class="annot"><span class="annottext">traverseLowerEnvelope :: forall (f :: * -&gt; *) plane plane'.
(Applicative f, NumType plane ~ NumType plane', Ord plane') =&gt;
(plane -&gt; f plane')
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane')
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#traverseLowerEnvelope"><span class="hs-identifier hs-var hs-var">traverseLowerEnvelope</span></a></span></span><span> </span><span id="local-6989586621679463103"><span class="annot"><span class="annottext">plane -&gt; f plane'
</span><a href="#local-6989586621679463103"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span id="local-6989586621679463104"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679463104"><span class="hs-identifier hs-var">v0</span></a></span></span><span> </span><span id="local-6989586621679463105"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679463105"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">UnboundedVertex plane'
-&gt; Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane'
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">(UnboundedVertex plane'
 -&gt; Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane')
-&gt; f (UnboundedVertex plane')
-&gt; f (Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(plane -&gt; f plane')
-&gt; UnboundedVertex plane -&gt; f (UnboundedVertex plane')
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; UnboundedVertex a -&gt; f (UnboundedVertex b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">plane -&gt; f plane'
</span><a href="#local-6989586621679463103"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679463104"><span class="hs-identifier hs-var">v0</span></a></span><span> </span><span class="annot"><span class="annottext">f (Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane')
-&gt; f (Seq (BoundedVertex plane')) -&gt; f (LowerEnvelope' plane')
forall a b. f (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(BoundedVertex plane -&gt; f (BoundedVertex plane'))
-&gt; Seq (BoundedVertex plane) -&gt; f (Seq (BoundedVertex plane'))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Seq a -&gt; f (Seq b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(plane -&gt; f plane')
-&gt; BoundedVertex plane -&gt; f (BoundedVertex plane')
forall (f :: * -&gt; *) (g :: * -&gt; *) plane plane'.
(Traversable f, Applicative g, NumType plane ~ NumType plane',
 Ord plane') =&gt;
(plane -&gt; g plane')
-&gt; BoundedVertexF f plane -&gt; g (BoundedVertexF f plane')
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#traverseBoundedV"><span class="hs-identifier hs-var">traverseBoundedV</span></a></span><span> </span><span class="annot"><span class="annottext">plane -&gt; f plane'
</span><a href="#local-6989586621679463103"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679463105"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><span class="hs-comment">-- | lens to access the unbounded vertex</span></span><span>
</span><span id="line-106"></span><span id="local-6989586621679462467"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#theUnboundedVertex"><span class="hs-identifier hs-type">theUnboundedVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462467"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier hs-type">UnboundedVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462467"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-107"></span><span id="theUnboundedVertex"><span class="annot"><span class="annottext">theUnboundedVertex :: forall plane (f :: * -&gt; *).
Functor f =&gt;
(UnboundedVertex plane -&gt; f (UnboundedVertex plane))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#theUnboundedVertex"><span class="hs-identifier hs-var hs-var">theUnboundedVertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LowerEnvelope' plane -&gt; UnboundedVertex plane)
-&gt; (LowerEnvelope' plane
    -&gt; UnboundedVertex plane -&gt; LowerEnvelope' plane)
-&gt; Lens
     (LowerEnvelope' plane)
     (LowerEnvelope' plane)
     (UnboundedVertex plane)
     (UnboundedVertex plane)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span id="local-6989586621679463111"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679463111"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679463111"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>                          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679463112"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679463112"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679463113"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679463113"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679463113"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679463112"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | Lens to access the sequence of bounded vertices.</span></span><span>
</span><span id="line-111"></span><span id="local-6989586621679462441"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#boundedVertices"><span class="hs-identifier hs-type">boundedVertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462441"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#BoundedVertex"><span class="hs-identifier hs-type">BoundedVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462441"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-112"></span><span id="boundedVertices"><span class="annot"><span class="annottext">boundedVertices :: forall plane (f :: * -&gt; *).
Functor f =&gt;
(Seq (BoundedVertex plane) -&gt; f (Seq (BoundedVertex plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#boundedVertices"><span class="hs-identifier hs-var hs-var">boundedVertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LowerEnvelope' plane -&gt; Seq (BoundedVertex plane))
-&gt; (LowerEnvelope' plane
    -&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane)
-&gt; Lens
     (LowerEnvelope' plane)
     (LowerEnvelope' plane)
     (Seq (BoundedVertex plane))
     (Seq (BoundedVertex plane))
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679463116"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679463116"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679463116"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>                       </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span id="local-6989586621679463117"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679463117"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span> </span><span id="local-6989586621679463118"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679463118"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679463117"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679463118"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><span class="hs-comment">-- | Given a single Vertex, construct a LowerEnvelope' out of it.</span></span><span>
</span><span id="line-118"></span><span id="local-6989586621679462477"><span id="local-6989586621679462478"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#singleton"><span class="hs-identifier hs-type">singleton</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679462477"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462478"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462478"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679462478"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462477"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.VertexForm.html#LEVertex"><span class="hs-identifier hs-type">VertexForm.LEVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462477"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462477"><span class="hs-identifier hs-type">plane</span></a></span></span></span><span>
</span><span id="line-120"></span><span id="singleton"><span class="annot"><span class="annottext">singleton :: forall plane r.
(Plane_ plane r, Ord r, Fractional r, Ord plane) =&gt;
LEVertex plane -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#singleton"><span class="hs-identifier hs-var hs-var">singleton</span></a></span></span><span> </span><span id="local-6989586621679463196"><span class="annot"><span class="annottext">LEVertex plane
</span><a href="#local-6989586621679463196"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Seq (BoundedVertexF Seq plane) -&gt; LowerEnvelope' plane
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679463197"><span class="hs-identifier hs-var">v0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedVertexF Seq plane -&gt; Seq (BoundedVertexF Seq plane)
forall a. a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.singleton</span></span><span> </span><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679463199"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621679463202"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679463202"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-comment">-- the vertexID we are using for this vertex.</span><span>
</span><span id="line-123"></span><span>    </span><span id="local-6989586621679463199"><span class="annot"><span class="annottext">v' :: BoundedVertexF Seq plane
</span><a href="#local-6989586621679463199"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LEVertex plane -&gt; BoundedVertexF Seq plane
forall plane r.
(Plane_ plane r, Ord r, Fractional r, Ord plane) =&gt;
LEVertex plane -&gt; BoundedVertex plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#fromLEVertex"><span class="hs-identifier hs-var">fromLEVertex</span></a></span><span> </span><span class="annot"><span class="annottext">LEVertex plane
</span><a href="#local-6989586621679463196"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679463197"><span class="annot"><span class="annottext">v0 :: UnboundedVertex plane
</span><a href="#local-6989586621679463197"><span class="hs-identifier hs-var hs-var">v0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (LEEdge plane) -&gt; UnboundedVertex plane
forall plane. Seq (LEEdge plane) -&gt; UnboundedVertex plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier hs-var">UnboundedVertex</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (LEEdge plane) -&gt; UnboundedVertex plane)
-&gt; Seq (LEEdge plane) -&gt; UnboundedVertex plane
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; LEEdge plane -&gt; LEEdge plane
forall plane. Int -&gt; LEEdge plane -&gt; LEEdge plane
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#flipEdge"><span class="hs-identifier hs-var">flipEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679463202"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(LEEdge plane -&gt; LEEdge plane)
-&gt; Seq (LEEdge plane) -&gt; Seq (LEEdge plane)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Seq (LEEdge plane))
  (BoundedVertexF Seq plane)
  (Seq (LEEdge plane))
-&gt; BoundedVertexF Seq plane -&gt; Seq (LEEdge plane)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Seq (LEEdge plane))
  (BoundedVertexF Seq plane)
  (Seq (LEEdge plane))
forall (f1 :: * -&gt; *) plane (g :: * -&gt; *) (f2 :: * -&gt; *).
Functor f2 =&gt;
(f1 (LEEdge plane) -&gt; f2 (g (LEEdge plane)))
-&gt; BoundedVertexF f1 plane -&gt; f2 (BoundedVertexF g plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#incidentEdgesB"><span class="hs-identifier hs-var">incidentEdgesB</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679463199"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-comment">-- do we need to reverse the sequenceo f edges?</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><span class="hs-comment">-- | The unbounded vertex.</span></span><span>
</span><span id="line-130"></span><span class="hs-keyword">newtype</span><span> </span><span id="UnboundedVertex"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier hs-var">UnboundedVertex</span></a></span></span><span> </span><span id="local-6989586621679462513"><span class="annot"><a href="#local-6989586621679462513"><span class="hs-identifier hs-type">plane</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UnboundedVertex"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier hs-var">UnboundedVertex</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_incidentEdgesU"><span class="annot"><span class="annottext">forall plane. UnboundedVertex plane -&gt; Seq (LEEdge plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#_incidentEdgesU"><span class="hs-identifier hs-var hs-var">_incidentEdgesU</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462513"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-131"></span><span>                              </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679463210"><span id="local-6989586621679463215"><span id="local-6989586621679463218"><span class="annot"><span class="annottext">Int -&gt; UnboundedVertex plane -&gt; ShowS
[UnboundedVertex plane] -&gt; ShowS
UnboundedVertex plane -&gt; String
(Int -&gt; UnboundedVertex plane -&gt; ShowS)
-&gt; (UnboundedVertex plane -&gt; String)
-&gt; ([UnboundedVertex plane] -&gt; ShowS)
-&gt; Show (UnboundedVertex plane)
forall plane. Show plane =&gt; Int -&gt; UnboundedVertex plane -&gt; ShowS
forall plane. Show plane =&gt; [UnboundedVertex plane] -&gt; ShowS
forall plane. Show plane =&gt; UnboundedVertex plane -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall plane. Show plane =&gt; Int -&gt; UnboundedVertex plane -&gt; ShowS
showsPrec :: Int -&gt; UnboundedVertex plane -&gt; ShowS
$cshow :: forall plane. Show plane =&gt; UnboundedVertex plane -&gt; String
show :: UnboundedVertex plane -&gt; String
$cshowList :: forall plane. Show plane =&gt; [UnboundedVertex plane] -&gt; ShowS
showList :: [UnboundedVertex plane] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679463222"><span id="local-6989586621679463227"><span class="annot"><span class="annottext">UnboundedVertex plane -&gt; UnboundedVertex plane -&gt; Bool
(UnboundedVertex plane -&gt; UnboundedVertex plane -&gt; Bool)
-&gt; (UnboundedVertex plane -&gt; UnboundedVertex plane -&gt; Bool)
-&gt; Eq (UnboundedVertex plane)
forall plane.
Eq plane =&gt;
UnboundedVertex plane -&gt; UnboundedVertex plane -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall plane.
Eq plane =&gt;
UnboundedVertex plane -&gt; UnboundedVertex plane -&gt; Bool
== :: UnboundedVertex plane -&gt; UnboundedVertex plane -&gt; Bool
$c/= :: forall plane.
Eq plane =&gt;
UnboundedVertex plane -&gt; UnboundedVertex plane -&gt; Bool
/= :: UnboundedVertex plane -&gt; UnboundedVertex plane -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679463232"><span id="local-6989586621679463237"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; UnboundedVertex a -&gt; UnboundedVertex b)
-&gt; (forall a b. a -&gt; UnboundedVertex b -&gt; UnboundedVertex a)
-&gt; Functor UnboundedVertex
forall a b. a -&gt; UnboundedVertex b -&gt; UnboundedVertex a
forall a b. (a -&gt; b) -&gt; UnboundedVertex a -&gt; UnboundedVertex b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; UnboundedVertex a -&gt; UnboundedVertex b
fmap :: forall a b. (a -&gt; b) -&gt; UnboundedVertex a -&gt; UnboundedVertex b
$c&lt;$ :: forall a b. a -&gt; UnboundedVertex b -&gt; UnboundedVertex a
&lt;$ :: forall a b. a -&gt; UnboundedVertex b -&gt; UnboundedVertex a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679463243"><span id="local-6989586621679463249"><span id="local-6989586621679463258"><span id="local-6989586621679463263"><span id="local-6989586621679463267"><span id="local-6989586621679463270"><span id="local-6989586621679463273"><span id="local-6989586621679463276"><span id="local-6989586621679463279"><span id="local-6989586621679463282"><span id="local-6989586621679463285"><span id="local-6989586621679463289"><span id="local-6989586621679463292"><span id="local-6989586621679463297"><span id="local-6989586621679463302"><span id="local-6989586621679463307"><span id="local-6989586621679463312"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; UnboundedVertex m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; UnboundedVertex a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; UnboundedVertex a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; UnboundedVertex a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; UnboundedVertex a -&gt; a)
-&gt; (forall a. UnboundedVertex a -&gt; [a])
-&gt; (forall a. UnboundedVertex a -&gt; Bool)
-&gt; (forall a. UnboundedVertex a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; UnboundedVertex a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; UnboundedVertex a -&gt; a)
-&gt; (forall a. Ord a =&gt; UnboundedVertex a -&gt; a)
-&gt; (forall a. Num a =&gt; UnboundedVertex a -&gt; a)
-&gt; (forall a. Num a =&gt; UnboundedVertex a -&gt; a)
-&gt; Foldable UnboundedVertex
forall a. Eq a =&gt; a -&gt; UnboundedVertex a -&gt; Bool
forall a. Num a =&gt; UnboundedVertex a -&gt; a
forall a. Ord a =&gt; UnboundedVertex a -&gt; a
forall m. Monoid m =&gt; UnboundedVertex m -&gt; m
forall a. UnboundedVertex a -&gt; Bool
forall a. UnboundedVertex a -&gt; Int
forall a. UnboundedVertex a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; UnboundedVertex a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; UnboundedVertex a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall m. Monoid m =&gt; UnboundedVertex m -&gt; m
fold :: forall m. Monoid m =&gt; UnboundedVertex m -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; UnboundedVertex a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; UnboundedVertex a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; UnboundedVertex a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; UnboundedVertex a -&gt; m
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedVertex a -&gt; b
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; UnboundedVertex a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; UnboundedVertex a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; UnboundedVertex a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; UnboundedVertex a -&gt; a
$ctoList :: forall a. UnboundedVertex a -&gt; [a]
toList :: forall a. UnboundedVertex a -&gt; [a]
$cnull :: forall a. UnboundedVertex a -&gt; Bool
null :: forall a. UnboundedVertex a -&gt; Bool
$clength :: forall a. UnboundedVertex a -&gt; Int
length :: forall a. UnboundedVertex a -&gt; Int
$celem :: forall a. Eq a =&gt; a -&gt; UnboundedVertex a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; UnboundedVertex a -&gt; Bool
$cmaximum :: forall a. Ord a =&gt; UnboundedVertex a -&gt; a
maximum :: forall a. Ord a =&gt; UnboundedVertex a -&gt; a
$cminimum :: forall a. Ord a =&gt; UnboundedVertex a -&gt; a
minimum :: forall a. Ord a =&gt; UnboundedVertex a -&gt; a
$csum :: forall a. Num a =&gt; UnboundedVertex a -&gt; a
sum :: forall a. Num a =&gt; UnboundedVertex a -&gt; a
$cproduct :: forall a. Num a =&gt; UnboundedVertex a -&gt; a
product :: forall a. Num a =&gt; UnboundedVertex a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679463322"><span id="local-6989586621679463332"><span id="local-6989586621679463337"><span id="local-6989586621679463342"><span class="annot"><span class="annottext">Functor UnboundedVertex
Foldable UnboundedVertex
(Functor UnboundedVertex, Foldable UnboundedVertex) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; UnboundedVertex a -&gt; f (UnboundedVertex b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    UnboundedVertex (f a) -&gt; f (UnboundedVertex a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; UnboundedVertex a -&gt; m (UnboundedVertex b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    UnboundedVertex (m a) -&gt; m (UnboundedVertex a))
-&gt; Traversable UnboundedVertex
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
UnboundedVertex (m a) -&gt; m (UnboundedVertex a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
UnboundedVertex (f a) -&gt; f (UnboundedVertex a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; UnboundedVertex a -&gt; m (UnboundedVertex b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; UnboundedVertex a -&gt; f (UnboundedVertex b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; UnboundedVertex a -&gt; f (UnboundedVertex b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; UnboundedVertex a -&gt; f (UnboundedVertex b)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
UnboundedVertex (f a) -&gt; f (UnboundedVertex a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
UnboundedVertex (f a) -&gt; f (UnboundedVertex a)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; UnboundedVertex a -&gt; m (UnboundedVertex b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; UnboundedVertex a -&gt; m (UnboundedVertex b)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
UnboundedVertex (m a) -&gt; m (UnboundedVertex a)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
UnboundedVertex (m a) -&gt; m (UnboundedVertex a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><span class="hs-comment">-- | access the incidentEdges of an unbounded vertex</span></span><span>
</span><span id="line-134"></span><span id="local-6989586621679462567"><span id="local-6989586621679462568"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#incidentEdgesU"><span class="hs-identifier hs-type">incidentEdgesU</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Type.html#Iso"><span class="hs-identifier hs-type">Iso</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier hs-type">UnboundedVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462567"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier hs-type">UnboundedVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462568"><span class="hs-identifier hs-type">plane'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462567"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462568"><span class="hs-identifier hs-type">plane'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-136"></span><span id="incidentEdgesU"><span class="annot"><span class="annottext">incidentEdgesU :: forall plane plane' (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Profunctor p, Functor f) =&gt;
p (Seq (LEEdge plane)) (f (Seq (LEEdge plane')))
-&gt; p (UnboundedVertex plane) (f (UnboundedVertex plane'))
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#incidentEdgesU"><span class="hs-identifier hs-var hs-var">incidentEdgesU</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p (Seq (LEEdge plane)) (f (Seq (LEEdge plane')))
-&gt; p (UnboundedVertex plane) (f (UnboundedVertex plane'))
forall s t a b. (Coercible s a, Coercible t b) =&gt; Iso s t a b
Iso
  (UnboundedVertex plane)
  (UnboundedVertex plane')
  (Seq (LEEdge plane))
  (Seq (LEEdge plane'))
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Iso.html#coerced"><span class="hs-identifier hs-var">coerced</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><span class="hs-comment">-- | The vertexID of the unbounded vertex</span></span><span>
</span><span id="line-139"></span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#unboundedVertexId"><span class="hs-identifier hs-type">unboundedVertexId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span>
</span><span id="line-140"></span><span id="unboundedVertexId"><span class="annot"><span class="annottext">unboundedVertexId :: Int
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#unboundedVertexId"><span class="hs-identifier hs-var hs-var">unboundedVertexId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><span class="hs-comment">-- | Vertices in of the lower envelope in adjacencylist form.</span></span><span>
</span><span id="line-145"></span><span class="hs-keyword">type</span><span> </span><span id="BoundedVertex"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#BoundedVertex"><span class="hs-identifier hs-var">BoundedVertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#BoundedVertexF"><span class="hs-identifier hs-type">BoundedVertexF</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | Given a vertex in vertex form, construct A BoundedVertex from</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- it. Note that this essentially assumes the vertex is connected to</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- the unbounded vertex with all its outgoing edgse.</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- \(O(k \log k)\), where \(k\) is the number of definers.</span><span>
</span><span id="line-152"></span><span id="local-6989586621679462511"><span id="local-6989586621679462512"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#fromLEVertex"><span class="hs-identifier hs-type">fromLEVertex</span></a></span><span>                              </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679462511"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462512"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462512"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679462512"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462511"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>                                          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.VertexForm.html#LEVertex"><span class="hs-identifier hs-type">VertexForm.LEVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462511"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-154"></span><span>                                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#BoundedVertex"><span class="hs-identifier hs-type">BoundedVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462511"><span class="hs-identifier hs-type">plane</span></a></span></span></span><span>
</span><span id="line-155"></span><span id="fromLEVertex"><span class="annot"><span class="annottext">fromLEVertex :: forall plane r.
(Plane_ plane r, Ord r, Fractional r, Ord plane) =&gt;
LEVertex plane -&gt; BoundedVertex plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#fromLEVertex"><span class="hs-identifier hs-var hs-var">fromLEVertex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.VertexForm.html#LEVertex"><span class="hs-identifier hs-type">VertexForm.LEVertex</span></a></span><span> </span><span id="local-6989586621679463384"><span class="annot"><span class="annottext">Point 3 (NumType plane)
</span><a href="#local-6989586621679463384"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679463385"><span class="annot"><span class="annottext">Definers plane
</span><a href="#local-6989586621679463385"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 3 (NumType plane)
-&gt; Definers plane -&gt; Seq (LEEdge plane) -&gt; BoundedVertexF Seq plane
forall (f :: * -&gt; *) plane.
Point 3 (NumType plane)
-&gt; Set plane -&gt; f (LEEdge plane) -&gt; BoundedVertexF f plane
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span> </span><span class="annot"><span class="annottext">Point 3 (NumType plane)
</span><a href="#local-6989586621679463384"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Definers plane
</span><a href="#local-6989586621679463385"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (LEEdge plane)
</span><a href="#local-6989586621679463386"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679463386"><span class="annot"><span class="annottext">es :: Seq (LEEdge plane)
</span><a href="#local-6989586621679463386"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier hs-type">EdgeDefiners</span></a></span><span> </span><span id="local-6989586621679463389"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463389"><span class="hs-identifier hs-var">hl</span></a></span></span><span> </span><span id="local-6989586621679463390"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463390"><span class="hs-identifier hs-var">hr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; plane -&gt; plane -&gt; LEEdge plane
forall plane. Int -&gt; plane -&gt; plane -&gt; LEEdge plane
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#Edge"><span class="hs-identifier hs-var">Edge</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#unboundedVertexId"><span class="hs-identifier hs-var">unboundedVertexId</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463389"><span class="hs-identifier hs-var">hl</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463390"><span class="hs-identifier hs-var">hr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((HalfLine (Point 2 r) :+ EdgeDefiners plane) -&gt; LEEdge plane)
-&gt; Seq (HalfLine (Point 2 r) :+ EdgeDefiners plane)
-&gt; Seq (LEEdge plane)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[HalfLine (Point 2 r) :+ EdgeDefiners plane]
-&gt; Seq (HalfLine (Point 2 r) :+ EdgeDefiners plane)
forall (f :: * -&gt; *) r e.
(Foldable f, Ord r, Num r) =&gt;
f (HalfLine (Point 2 r) :+ e) -&gt; Seq (HalfLine (Point 2 r) :+ e)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#sortAroundStart"><span class="hs-identifier hs-var">sortAroundStart</span></a></span><span> </span><span class="annot"><span class="annottext">[HalfLine (Point 2 r) :+ EdgeDefiners plane]
</span><a href="#local-6989586621679463393"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679463393"><span class="annot"><span class="annottext">es' :: [HalfLine (Point 2 r) :+ EdgeDefiners plane]
</span><a href="#local-6989586621679463393"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Two plane -&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane))
-&gt; [Two plane] -&gt; [HalfLine (Point 2 r) :+ EdgeDefiners plane]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b.
Filterable f =&gt;
(a -&gt; Maybe b) -&gt; f a -&gt; f b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/witherable-0.5-c5edceb70d9a4ac9829d3530022ba57205cc54de81b5a712afa5707c9d26bdde/share/doc/html/src/Witherable.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679463395"><span class="annot"><span class="annottext">t :: Two plane
</span><a href="#local-6989586621679463395"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span id="local-6989586621679463397"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463397"><span class="hs-identifier hs-var">h1</span></a></span></span><span> </span><span id="local-6989586621679463398"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463398"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679463399"><span class="annot"><span class="annottext">defs' :: NonEmpty plane
</span><a href="#local-6989586621679463399"><span class="hs-identifier hs-var hs-var">defs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definers plane -&gt; NonEmpty plane
forall {t :: * -&gt; *} {a}. Foldable t =&gt; t a -&gt; NonEmpty a
</span><a href="#local-6989586621679463400"><span class="hs-identifier hs-var">toNonEmpty'</span></a></span><span> </span><span class="annot"><span class="annottext">(Definers plane -&gt; NonEmpty plane)
-&gt; Definers plane -&gt; NonEmpty plane
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">plane -&gt; Definers plane -&gt; Definers plane
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.delete</span></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463397"><span class="hs-identifier hs-var">h1</span></a></span><span> </span><span class="annot"><span class="annottext">(Definers plane -&gt; Definers plane)
-&gt; Definers plane -&gt; Definers plane
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">plane -&gt; Definers plane -&gt; Definers plane
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.delete</span></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463398"><span class="hs-identifier hs-var">h2</span></a></span><span> </span><span class="annot"><span class="annottext">Definers plane
</span><a href="#local-6989586621679463385"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-159"></span><span>                                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Point 3 r
-&gt; Two plane
-&gt; NonEmpty plane
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
forall plane r (f :: * -&gt; *).
(Plane_ plane r, Ord r, Fractional r, Foldable1 f) =&gt;
Point 3 r
-&gt; Two plane
-&gt; f plane
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#outgoingUnboundedEdge"><span class="hs-identifier hs-var">outgoingUnboundedEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Point 3 r
Point 3 (NumType plane)
</span><a href="#local-6989586621679463384"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Two plane
</span><a href="#local-6989586621679463395"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty plane
</span><a href="#local-6989586621679463399"><span class="hs-identifier hs-var">defs'</span></a></span><span>
</span><span id="line-160"></span><span>                   </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Two plane] -&gt; [HalfLine (Point 2 r) :+ EdgeDefiners plane])
-&gt; [Two plane] -&gt; [HalfLine (Point 2 r) :+ EdgeDefiners plane]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Definers plane -&gt; [Two plane]
forall (f :: * -&gt; *) a. Foldable f =&gt; f a -&gt; [Two a]
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html#uniquePairs"><span class="hs-identifier hs-var">uniquePairs</span></a></span><span> </span><span class="annot"><span class="annottext">Definers plane
</span><a href="#local-6989586621679463385"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679463400"><span class="annot"><span class="annottext">toNonEmpty' :: t a -&gt; NonEmpty a
</span><a href="#local-6989586621679463400"><span class="hs-identifier hs-var hs-var">toNonEmpty'</span></a></span></span><span> </span><span id="local-6989586621679463407"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679463407"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe (NonEmpty a)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NonEmpty.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Maybe (NonEmpty a)) -&gt; [a] -&gt; Maybe (NonEmpty a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t a -&gt; [a]
forall a. t a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679463407"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679463410"><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679463410"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonEmpty a
</span><a href="#local-6989586621679463410"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-163"></span><span>                      </span><span class="annot"><span class="annottext">Maybe (NonEmpty a)
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; NonEmpty a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fromLEVertex: absurd, there should be at least 3 definers&quot;</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Given a bunch of halflines that all share their starting point v,</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- sort them cyclically around the starting point v.</span><span>
</span><span id="line-168"></span><span id="local-6989586621679462590"><span id="local-6989586621679462591"><span id="local-6989586621679462592"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#sortAroundStart"><span class="hs-identifier hs-type">sortAroundStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679462590"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462591"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679462591"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462590"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462591"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462592"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462591"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462592"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-170"></span><span id="sortAroundStart"><span class="annot"><span class="annottext">sortAroundStart :: forall (f :: * -&gt; *) r e.
(Foldable f, Ord r, Num r) =&gt;
f (HalfLine (Point 2 r) :+ e) -&gt; Seq (HalfLine (Point 2 r) :+ e)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#sortAroundStart"><span class="hs-identifier hs-var hs-var">sortAroundStart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (HalfLine (Point 2 r) :+ e)
-&gt; Seq (HalfLine (Point 2 r) :+ e)
forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(HasFromFoldable f, Foldable g) =&gt;
g a -&gt; f a
forall (g :: * -&gt; *) a. Foldable g =&gt; g a -&gt; Seq a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Util.html#fromFoldable"><span class="hs-identifier hs-var">fromFoldable</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (HalfLine (Point 2 r) :+ e)
 -&gt; Seq (HalfLine (Point 2 r) :+ e))
-&gt; (f (HalfLine (Point 2 r) :+ e)
    -&gt; Vector (HalfLine (Point 2 r) :+ e))
-&gt; f (HalfLine (Point 2 r) :+ e)
-&gt; Seq (HalfLine (Point 2 r) :+ e)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (vector :: * -&gt; *) (f :: * -&gt; *) a.
(Foldable f, Vector vector a) =&gt;
(a -&gt; a -&gt; Ordering) -&gt; f a -&gt; vector a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Sort.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/vector-0.13.1.0-29d63c43381c98813efe04876e9ecdc0f12f411fd574c0bcbf808e7a8274dea3/share/doc/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">V.Vector</span></a></span><span> </span><span class="annot"><span class="annottext">(HalfLine (Point 2 r) :+ e)
-&gt; (HalfLine (Point 2 r) :+ e) -&gt; Ordering
forall {point} {point} {extra} {extra}.
(NumType point ~ NumType point, Dimension point ~ 2,
 Dimension point ~ 2, Point_ point 2 (NumType point),
 Ord (NumType point), Num (NumType point)) =&gt;
(HalfLine point :+ extra) -&gt; (HalfLine point :+ extra) -&gt; Ordering
</span><a href="#local-6989586621679463438"><span class="hs-identifier hs-var">compareAroundStart</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621679463438"><span class="annot"><span class="annottext">compareAroundStart :: (HalfLine point :+ extra) -&gt; (HalfLine point :+ extra) -&gt; Ordering
</span><a href="#local-6989586621679463438"><span class="hs-identifier hs-var hs-var">compareAroundStart</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span id="local-6989586621679463568"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679463568"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679463569"><span class="annot"><span class="annottext">Vector (Dimension point) (NumType point)
</span><a href="#local-6989586621679463569"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><span class="annottext">extra
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="annot"><span class="annottext">point
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679463570"><span class="annot"><span class="annottext">Vector (Dimension point) (NumType point)
</span><a href="#local-6989586621679463570"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><span class="annottext">extra
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; point -&gt; Ordering
forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
point -&gt; point -&gt; point -&gt; Ordering
</span><span class="hs-identifier hs-var">ccwCmpAround</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679463568"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679463568"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; Vector (Dimension point) (NumType point) -&gt; point
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector (Dimension point) (NumType point)
</span><a href="#local-6989586621679463569"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679463568"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; Vector (Dimension point) (NumType point) -&gt; point
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector (Dimension point) (NumType point)
</span><a href="#local-6989586621679463570"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Given a location of a vertex v, a pair of planes h1,h2 and the</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- remaining defining planes of v, computes the outgoing half-line</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- from v on which h1,h2 are the lowest (if such an halfline exists).</span><span>
</span><span id="line-180"></span><span id="local-6989586621679462600"><span id="local-6989586621679462601"><span id="local-6989586621679462602"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#outgoingUnboundedEdge"><span class="hs-identifier hs-type">outgoingUnboundedEdge</span></a></span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679462600"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462601"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462601"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679462601"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-181"></span><span>                                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679462602"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-182"></span><span>                                           </span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><a href="#local-6989586621679462601"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the location of the vertex v</span></span><span>
</span><span id="line-184"></span><span>                                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462600"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-comment">-- ^ the pair of planes for which to compute</span><span>
</span><span id="line-185"></span><span>                                        </span><span class="hs-comment">-- the halfine</span><span>
</span><span id="line-186"></span><span>                                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462602"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462600"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the other planes intersecting at v</span></span><span>
</span><span id="line-187"></span><span>                                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462601"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier hs-type">EdgeDefiners</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462600"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-188"></span><span id="outgoingUnboundedEdge"><span class="annot"><span class="annottext">outgoingUnboundedEdge :: forall plane r (f :: * -&gt; *).
(Plane_ plane r, Ord r, Fractional r, Foldable1 f) =&gt;
Point 3 r
-&gt; Two plane
-&gt; f plane
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#outgoingUnboundedEdge"><span class="hs-identifier hs-var hs-var">outgoingUnboundedEdge</span></a></span></span><span> </span><span id="local-6989586621679463623"><span class="annot"><span class="annottext">Point 3 r
</span><a href="#local-6989586621679463623"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span id="local-6989586621679463624"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463624"><span class="hs-identifier hs-var">h1</span></a></span></span><span> </span><span id="local-6989586621679463625"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463625"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679463626"><span class="annot"><span class="annottext">f plane
</span><a href="#local-6989586621679463626"><span class="hs-identifier hs-var">h3s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><span class="annottext">plane -&gt; plane -&gt; Maybe (LinePV 2 r :+ EdgeDefiners plane)
forall plane r.
(Plane_ plane r, Ord r, Fractional r) =&gt;
plane -&gt; plane -&gt; Maybe (LinePV 2 r :+ EdgeDefiners plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#intersectionLineWithDefiners"><span class="hs-identifier hs-var">intersectionLineWithDefiners</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463624"><span class="hs-identifier hs-var">h1</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463625"><span class="hs-identifier hs-var">h2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LinePV 2 r :+ EdgeDefiners plane)
-&gt; ((LinePV 2 r :+ EdgeDefiners plane)
    -&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane))
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
-&gt; f plane
-&gt; (LinePV 2 r :+ EdgeDefiners plane)
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
forall plane r (f :: * -&gt; *).
(Plane_ plane r, Foldable1 f, Fractional r, Ord r) =&gt;
Point 2 r
-&gt; f plane
-&gt; (LinePV 2 r :+ EdgeDefiners plane)
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#toHalfLineFrom"><span class="hs-identifier hs-var">toHalfLineFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 3 r -&gt; Point 2 r
forall (i :: Nat) point (d :: Nat) r.
(Point_ point d r, i &lt;= d, Has_ Vector_ i r) =&gt;
point -&gt; Point i r
</span><span class="hs-identifier hs-var">projectPoint</span></span><span> </span><span class="annot"><span class="annottext">Point 3 r
</span><a href="#local-6989586621679463623"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f plane
</span><a href="#local-6989586621679463626"><span class="hs-identifier hs-var">h3s</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-comment">-- todo, if there are more planes, I guess we should check if the hl is not dominated by the other</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-comment">-- planes either.</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Given :</span><span>
</span><span id="line-194"></span><span class="hs-comment">--</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- v : the projected location of the vertex</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- hs : the remaining planes defining v (typically just one plane h3)</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- l   : the (projection of the) line l in which planes h1 and h2 intersect (containing v)</span><span>
</span><span id="line-198"></span><span class="hs-comment">--</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- we compute the half-line eminating from v in which h1 and h2 define</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- an edge incident to v.</span><span>
</span><span id="line-201"></span><span id="local-6989586621679462660"><span id="local-6989586621679462661"><span id="local-6989586621679462662"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#toHalfLineFrom"><span class="hs-identifier hs-type">toHalfLineFrom</span></a></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679462660"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462661"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679462662"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679462661"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462661"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>                                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462661"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ vertex v</span></span><span>
</span><span id="line-203"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462662"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462660"><span class="hs-identifier hs-type">plane</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ the remaining plane(s) hs</span></span><span>
</span><span id="line-204"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462661"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier hs-type">EdgeDefiners</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462660"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the line l</span></span><span>
</span><span id="line-205"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462661"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier hs-type">EdgeDefiners</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462660"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-206"></span><span id="toHalfLineFrom"><span class="annot"><span class="annottext">toHalfLineFrom :: forall plane r (f :: * -&gt; *).
(Plane_ plane r, Foldable1 f, Fractional r, Ord r) =&gt;
Point 2 r
-&gt; f plane
-&gt; (LinePV 2 r :+ EdgeDefiners plane)
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#toHalfLineFrom"><span class="hs-identifier hs-var hs-var">toHalfLineFrom</span></a></span></span><span> </span><span id="local-6989586621679463732"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679463732"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679463733"><span class="annot"><span class="annottext">f plane
</span><a href="#local-6989586621679463733"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679463735"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679463735"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679463736"><span class="annot"><span class="annottext">defs :: EdgeDefiners plane
</span><a href="#local-6989586621679463736"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier hs-type">EdgeDefiners</span></a></span><span> </span><span id="local-6989586621679463737"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463737"><span class="hs-identifier hs-var">h1</span></a></span></span><span> </span><span id="local-6989586621679463738"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463738"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">Vector 2 r
-&gt; EdgeDefiners plane
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
</span><a href="#local-6989586621679463739"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679463735"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeDefiners plane
</span><a href="#local-6989586621679463736"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
-&gt; EdgeDefiners plane
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
</span><a href="#local-6989586621679463739"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; Vector 2 r -&gt; Vector 2 r
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
r -&gt; vector -&gt; vector
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679463735"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">plane -&gt; plane -&gt; EdgeDefiners plane
forall plane. plane -&gt; plane -&gt; EdgeDefiners plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier hs-var">EdgeDefiners</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463738"><span class="hs-identifier hs-var">h2</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463737"><span class="hs-identifier hs-var">h1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- We try both directions. Note that if we reverse the direction</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- of the line, what the left/right plane is changes.</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-comment">-- If neither direction works, then h1,h2 do not define a good</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-comment">-- direction. This should happen only when there are more than 3</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-comment">-- planes intersecting in v, i.e. in degernate sitatuions</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-comment">-- | test if direction d is a good direction, i.e. if towards direction d</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-comment">-- h1 (and thus also h2) is actually lower than all remaining defining planes.</span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621679463739"><span class="annot"><span class="annottext">validate :: Vector 2 r
-&gt; EdgeDefiners plane
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
</span><a href="#local-6989586621679463739"><span class="hs-identifier hs-var hs-var">validate</span></a></span></span><span> </span><span id="local-6989586621679463742"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679463742"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679463743"><span class="annot"><span class="annottext">EdgeDefiners plane
</span><a href="#local-6989586621679463743"><span class="hs-identifier hs-var">defs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679463744"><span class="annot"><span class="annottext">zVal :: plane -&gt; r
</span><a href="#local-6989586621679463744"><span class="hs-identifier hs-var hs-var">zVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; plane -&gt; r
forall point.
(Num r, 1 &lt;= 3, Point_ point (3 - 1) r) =&gt;
point -&gt; plane -&gt; r
forall hyperPlane (d :: Nat) r point.
(NonVerticalHyperPlane_ hyperPlane d r, Num r, 1 &lt;= d,
 Point_ point (d - 1) r) =&gt;
point -&gt; hyperPlane -&gt; r
</span><span class="hs-identifier hs-var">evalAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679463732"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; Point 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679463742"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(plane -&gt; Bool) -&gt; f plane -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679463747"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463747"><span class="hs-identifier hs-var">h3</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">plane -&gt; r
</span><a href="#local-6989586621679463744"><span class="hs-identifier hs-var">zVal</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463737"><span class="hs-identifier hs-var">h1</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">plane -&gt; r
</span><a href="#local-6989586621679463744"><span class="hs-identifier hs-var">zVal</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463747"><span class="hs-identifier hs-var">h3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f plane
</span><a href="#local-6989586621679463733"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-219"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(HalfLine (Point 2 r) :+ EdgeDefiners plane)
-&gt; Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
-&gt; Vector (Dimension (Point 2 r)) (NumType (Point 2 r))
-&gt; HalfLine (Point 2 r)
forall point.
point -&gt; Vector (Dimension point) (NumType point) -&gt; HalfLine point
</span><span class="hs-identifier hs-var">HalfLine</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679463732"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector (Dimension (Point 2 r)) (NumType (Point 2 r))
</span><a href="#local-6989586621679463742"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r)
-&gt; EdgeDefiners plane -&gt; HalfLine (Point 2 r) :+ EdgeDefiners plane
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">EdgeDefiners plane
</span><a href="#local-6989586621679463743"><span class="hs-identifier hs-var">defs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (HalfLine (Point 2 r) :+ EdgeDefiners plane)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | The planes left (above) and right (below) their intersection</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- line.</span><span>
</span><span id="line-226"></span><span class="hs-keyword">data</span><span> </span><span id="EdgeDefiners"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier hs-var">EdgeDefiners</span></a></span></span><span> </span><span id="local-6989586621679462680"><span class="annot"><a href="#local-6989586621679462680"><span class="hs-identifier hs-type">plane</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EdgeDefiners"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier hs-var">EdgeDefiners</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_leftPlane"><span class="annot"><span class="annottext">forall plane. EdgeDefiners plane -&gt; plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#_leftPlane"><span class="hs-identifier hs-var hs-var">_leftPlane</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679462680"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ above plane</span></span><span>
</span><span id="line-227"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span id="_rightPlane"><span class="annot"><span class="annottext">forall plane. EdgeDefiners plane -&gt; plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#_rightPlane"><span class="hs-identifier hs-var hs-var">_rightPlane</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679462680"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ below plane</span></span><span>
</span><span id="line-228"></span><span>                                       </span><span class="hs-special">}</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Computes the line in which the two planes intersect, and labels</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- the halfplanes with the lowest plane.</span><span>
</span><span id="line-232"></span><span class="hs-comment">--</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- The returned line will have h to its left and h' to its right.</span><span>
</span><span id="line-234"></span><span id="local-6989586621679462655"><span id="local-6989586621679462656"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#intersectionLineWithDefiners"><span class="hs-identifier hs-type">intersectionLineWithDefiners</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679462655"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462656"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462656"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679462656"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>                                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462655"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462655"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462656"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier hs-type">EdgeDefiners</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462655"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-236"></span><span id="intersectionLineWithDefiners"><span class="annot"><span class="annottext">intersectionLineWithDefiners :: forall plane r.
(Plane_ plane r, Ord r, Fractional r) =&gt;
plane -&gt; plane -&gt; Maybe (LinePV 2 r :+ EdgeDefiners plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#intersectionLineWithDefiners"><span class="hs-identifier hs-var hs-var">intersectionLineWithDefiners</span></a></span></span><span> </span><span id="local-6989586621679463759"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463759"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679463760"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463760"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePV 2 r
-&gt; EdgeDefiners plane -&gt; LinePV 2 r :+ EdgeDefiners plane
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">plane -&gt; plane -&gt; EdgeDefiners plane
forall plane. plane -&gt; plane -&gt; EdgeDefiners plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeDefiners"><span class="hs-identifier hs-var">EdgeDefiners</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463759"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463760"><span class="hs-identifier hs-var">h'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LinePV 2 r -&gt; LinePV 2 r :+ EdgeDefiners plane)
-&gt; Maybe (LinePV 2 r) -&gt; Maybe (LinePV 2 r :+ EdgeDefiners plane)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">plane -&gt; plane -&gt; Maybe (LinePV 2 r)
forall plane r.
(Plane_ plane r, Ord r, Fractional r) =&gt;
plane -&gt; plane -&gt; Maybe (LinePV 2 r)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#intersectionLine%27"><span class="hs-identifier hs-var">intersectionLine'</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463759"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463760"><span class="hs-identifier hs-var">h'</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Computes the line in which the two planes intersect. The returned line will have h to</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- its left and h' to its right.</span><span>
</span><span id="line-241"></span><span class="hs-comment">--</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span id="local-6989586621679462691"><span id="local-6989586621679462692"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#intersectionLine%27"><span class="hs-identifier hs-type">intersectionLine'</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679462691"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462692"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462692"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679462692"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462691"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462691"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462692"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-245"></span><span id="intersectionLine%27"><span class="annot"><span class="annottext">intersectionLine' :: forall plane r.
(Plane_ plane r, Ord r, Fractional r) =&gt;
plane -&gt; plane -&gt; Maybe (LinePV 2 r)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#intersectionLine%27"><span class="hs-identifier hs-var hs-var">intersectionLine'</span></a></span></span><span> </span><span id="local-6989586621679463903"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463903"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679463904"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463904"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">plane -&gt; plane -&gt; Maybe (VerticalOrLineEQ r)
forall plane r.
(Plane_ plane r, Fractional r, Eq r) =&gt;
plane -&gt; plane -&gt; Maybe (VerticalOrLineEQ r)
</span><a href="HGeometry.Plane.LowerEnvelope.VertexForm.html#intersectionLine"><span class="hs-identifier hs-var">intersectionLine</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463903"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463904"><span class="hs-identifier hs-var">h'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (VerticalOrLineEQ r)
-&gt; (VerticalOrLineEQ r -&gt; LinePV 2 r) -&gt; Maybe (LinePV 2 r)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">VerticalLineThrough</span></span><span> </span><span id="local-6989586621679463907"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679463907"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; Point 2 r -&gt; LinePV 2 r
</span><a href="#local-6989586621679463908"><span class="hs-identifier hs-var">reorient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><span class="hs-identifier hs-var">LinePV</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Point 2 r
forall r. r -&gt; r -&gt; Point 2 r
</span><span class="hs-identifier hs-var">Point2</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679463907"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Vector 2 r
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Point 2 r
forall r. r -&gt; r -&gt; Point 2 r
</span><span class="hs-identifier hs-var">Point2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679463907"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">NonVertical</span></span><span> </span><span id="local-6989586621679463912"><span class="annot"><span class="annottext">LineEQ r
</span><a href="#local-6989586621679463912"><span class="hs-identifier hs-var">l</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679463913"><span class="annot"><span class="annottext">l' :: LinePV 2 r
</span><a href="#local-6989586621679463913"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span id="local-6989586621679463914"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679463914"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineEQ r -&gt; LinePV 2 r
forall {r}. Num r =&gt; LineEQ r -&gt; LinePV 2 r
</span><a href="#local-6989586621679463915"><span class="hs-identifier hs-var">fromLineEQ</span></a></span><span> </span><span class="annot"><span class="annottext">LineEQ r
</span><a href="#local-6989586621679463912"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-248"></span><span>                             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; Point 2 r -&gt; LinePV 2 r
</span><a href="#local-6989586621679463908"><span class="hs-identifier hs-var">reorient</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679463913"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679463914"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Point 2 r -&gt; (Point 2 r -&gt; Point 2 r) -&gt; Point 2 r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(r -&gt; Identity r) -&gt; Point 2 r -&gt; Identity (Point 2 r)
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int (Point 2 r) r
</span><span class="hs-identifier hs-var">yCoord</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; Identity r) -&gt; Point 2 r -&gt; Identity (Point 2 r))
-&gt; (r -&gt; r) -&gt; Point 2 r -&gt; Point 2 r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Setter.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-comment">-- make sure h is to the left of the line</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679463908"><span class="annot"><span class="annottext">reorient :: LinePV 2 r -&gt; Point 2 r -&gt; LinePV 2 r
</span><a href="#local-6989586621679463908"><span class="hs-identifier hs-var hs-var">reorient</span></a></span></span><span> </span><span id="local-6989586621679463920"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679463920"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679463921"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679463921"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679463922"><span class="annot"><span class="annottext">f :: plane -&gt; r
</span><a href="#local-6989586621679463922"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; plane -&gt; r
forall point.
(Num r, 1 &lt;= 3, Point_ point (3 - 1) r) =&gt;
point -&gt; plane -&gt; r
forall hyperPlane (d :: Nat) r point.
(NonVerticalHyperPlane_ hyperPlane d r, Num r, 1 &lt;= d,
 Point_ point (d - 1) r) =&gt;
point -&gt; hyperPlane -&gt; r
</span><span class="hs-identifier hs-var">evalAt</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679463921"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-252"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">plane -&gt; r
</span><a href="#local-6989586621679463922"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463903"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">plane -&gt; r
</span><a href="#local-6989586621679463922"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679463904"><span class="hs-identifier hs-var">h'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679463920"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679463920"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">LinePV 2 r -&gt; (LinePV 2 r -&gt; LinePV 2 r) -&gt; LinePV 2 r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector 2 r -&gt; Identity (Vector 2 r))
-&gt; LinePV 2 r -&gt; Identity (LinePV 2 r)
forall (d :: Nat) r.
(Dimension (LinePV 2 r) ~ d, NumType (LinePV 2 r) ~ r) =&gt;
Lens' (LinePV 2 r) (Vector d r)
forall t (d :: Nat) r.
(HasDirection t, Dimension t ~ d, NumType t ~ r) =&gt;
Lens' t (Vector d r)
Lens' (LinePV 2 r) (Vector 2 r)
</span><span class="hs-identifier hs-var">direction</span></span><span> </span><span class="annot"><span class="annottext">((Vector 2 r -&gt; Identity (Vector 2 r))
 -&gt; LinePV 2 r -&gt; Identity (LinePV 2 r))
-&gt; (Vector 2 r -&gt; Vector 2 r) -&gt; LinePV 2 r -&gt; LinePV 2 r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Setter.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
vector -&gt; vector
</span><span class="hs-identifier hs-var">negated</span></span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621679463915"><span class="annot"><span class="annottext">fromLineEQ :: LineEQ r -&gt; LinePV 2 r
</span><a href="#local-6989586621679463915"><span class="hs-identifier hs-var hs-var">fromLineEQ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LineEQ</span></span><span> </span><span id="local-6989586621679463929"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679463929"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679463930"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679463930"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; LinePV 2 r
forall r. Num r =&gt; r -&gt; r -&gt; LinePV 2 r
</span><span class="hs-identifier hs-var">fromLinearFunction</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679463929"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679463930"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><span class="hs-comment">-- | Computes the supportingline of the (downward projection of) the edge.</span></span><span>
</span><span id="line-256"></span><span id="local-6989586621679462732"><span id="local-6989586621679462733"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#edgeIntersectionLine"><span class="hs-identifier hs-type">edgeIntersectionLine</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679462732"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462733"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462733"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679462733"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462732"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462733"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-258"></span><span id="edgeIntersectionLine"><span class="annot"><span class="annottext">edgeIntersectionLine :: forall plane r.
(Plane_ plane r, Ord r, Fractional r) =&gt;
LEEdge plane -&gt; LinePV 2 r
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#edgeIntersectionLine"><span class="hs-identifier hs-var hs-var">edgeIntersectionLine</span></a></span></span><span> </span><span id="local-6989586621679463942"><span class="annot"><span class="annottext">LEEdge plane
</span><a href="#local-6989586621679463942"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">plane -&gt; plane -&gt; Maybe (LinePV 2 r)
forall plane r.
(Plane_ plane r, Ord r, Fractional r) =&gt;
plane -&gt; plane -&gt; Maybe (LinePV 2 r)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#intersectionLine%27"><span class="hs-identifier hs-var">intersectionLine'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LEEdge plane
</span><a href="#local-6989586621679463942"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">LEEdge plane -&gt; Getting plane (LEEdge plane) plane -&gt; plane
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting plane (LEEdge plane) plane
forall plane (f :: * -&gt; *).
Functor f =&gt;
(plane -&gt; f plane) -&gt; LEEdge plane -&gt; f (LEEdge plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#leftPlane"><span class="hs-identifier hs-var">leftPlane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LEEdge plane
</span><a href="#local-6989586621679463942"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">LEEdge plane -&gt; Getting plane (LEEdge plane) plane -&gt; plane
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting plane (LEEdge plane) plane
forall plane (f :: * -&gt; *).
Functor f =&gt;
(plane -&gt; f plane) -&gt; LEEdge plane -&gt; f (LEEdge plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#rightPlane"><span class="hs-identifier hs-var">rightPlane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679463946"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679463946"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679463946"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">Maybe (LinePV 2 r)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; LinePV 2 r
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;edgeIntersectionLine: absurd. no intersection line !?&quot;</span></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><span class="hs-comment">-- | Types that have an IncidentEdges' field.</span></span><span>
</span><span id="line-267"></span><span class="hs-keyword">class</span><span> </span><span id="HasIncidentEdges"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#HasIncidentEdges"><span class="hs-identifier hs-var">HasIncidentEdges</span></a></span></span><span> </span><span id="local-6989586621679462742"><span class="annot"><a href="#local-6989586621679462742"><span class="hs-identifier hs-type">t</span></a></span></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-comment">-- | Lens to access the incident edges field.</span><span>
</span><span id="line-269"></span><span>  </span><span id="incidentEdges%27"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#incidentEdges%27"><span class="hs-identifier hs-type">incidentEdges'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679462740"><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679462742"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462740"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462740"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#HasIncidentEdges"><span class="hs-identifier hs-type">HasIncidentEdges</span></a></span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier hs-type">UnboundedVertex</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>  </span><span id="local-6989586621679463955"><span class="annot"><span class="annottext">incidentEdges' :: forall plane. Lens' (UnboundedVertex plane) (Seq (LEEdge plane))
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#incidentEdges%27"><span class="hs-identifier hs-var hs-var hs-var hs-var">incidentEdges'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
-&gt; UnboundedVertex plane -&gt; f (UnboundedVertex plane)
forall plane plane' (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Profunctor p, Functor f) =&gt;
p (Seq (LEEdge plane)) (f (Seq (LEEdge plane')))
-&gt; p (UnboundedVertex plane) (f (UnboundedVertex plane'))
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#incidentEdgesU"><span class="hs-identifier hs-var">incidentEdgesU</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#HasIncidentEdges"><span class="hs-identifier hs-type">HasIncidentEdges</span></a></span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#BoundedVertex"><span class="hs-identifier hs-type">BoundedVertex</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679463962"><span class="annot"><span class="annottext">incidentEdges' :: forall plane. Lens' (BoundedVertex plane) (Seq (LEEdge plane))
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#incidentEdges%27"><span class="hs-identifier hs-var hs-var hs-var hs-var">incidentEdges'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BoundedVertexF Seq plane -&gt; Seq (LEEdge plane))
-&gt; (BoundedVertexF Seq plane
    -&gt; Seq (LEEdge plane) -&gt; BoundedVertexF Seq plane)
-&gt; Lens
     (BoundedVertexF Seq plane)
     (BoundedVertexF Seq plane)
     (Seq (LEEdge plane))
     (Seq (LEEdge plane))
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (Seq (LEEdge plane))
  (BoundedVertexF Seq plane)
  (Seq (LEEdge plane))
-&gt; BoundedVertexF Seq plane -&gt; Seq (LEEdge plane)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Seq (LEEdge plane))
  (BoundedVertexF Seq plane)
  (Seq (LEEdge plane))
forall (f1 :: * -&gt; *) plane (g :: * -&gt; *) (f2 :: * -&gt; *).
Functor f2 =&gt;
(f1 (LEEdge plane) -&gt; f2 (g (LEEdge plane)))
-&gt; BoundedVertexF f1 plane -&gt; f2 (BoundedVertexF g plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#incidentEdgesB"><span class="hs-identifier hs-var">incidentEdgesB</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span id="local-6989586621679463963"><span class="annot"><span class="annottext">Point 3 (NumType plane)
</span><a href="#local-6989586621679463963"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679463964"><span class="annot"><span class="annottext">Set plane
</span><a href="#local-6989586621679463964"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="annottext">Seq (LEEdge plane)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679463965"><span class="annot"><span class="annottext">Seq (LEEdge plane)
</span><a href="#local-6989586621679463965"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 3 (NumType plane)
-&gt; Set plane -&gt; Seq (LEEdge plane) -&gt; BoundedVertexF Seq plane
forall (f :: * -&gt; *) plane.
Point 3 (NumType plane)
-&gt; Set plane -&gt; f (LEEdge plane) -&gt; BoundedVertexF f plane
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span><span> </span><span class="annot"><span class="annottext">Point 3 (NumType plane)
</span><a href="#local-6989586621679463963"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Set plane
</span><a href="#local-6989586621679463964"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (LEEdge plane)
</span><a href="#local-6989586621679463965"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- instance HasIncidentEdges (Vertex (LowerEnvelope' plane)) plane where</span><span>
</span><span id="line-278"></span><span class="hs-comment">--   incidentEdges' = undefined -- pick either incidentEdges on the left or on the right thing.</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-282"></span><span class="annot"><span class="hs-comment">-- * The Instances for HasVertices, HasDarts, HasFaces etc</span></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679462754"><span id="local-6989586621679463968"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#HasVertices%27"><span class="hs-identifier hs-type">HasVertices'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Vertex"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#UnboundedVertex"><span class="hs-identifier hs-type">UnboundedVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#BoundedVertex"><span class="hs-identifier hs-type">BoundedVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="VertexIx"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-var">VertexIx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-comment">-- | note, trying to assign the unbounded vertex to something with index /=</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-comment">-- unboundedVertexId is an error.</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-type">vertexAt</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span>
</span><span id="line-291"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Type.html#IndexedTraversal%27"><span class="hs-identifier hs-type">IndexedTraversal'</span></a></span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>                                                </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679463994"><span class="annot"><span class="annottext">vertexAt :: Int
-&gt; IndexedTraversal'
     Int (LowerEnvelope' plane) (Vertex (LowerEnvelope' plane))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-var hs-var hs-var hs-var">vertexAt</span></a></span></span><span> </span><span id="local-6989586621679463995"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679463995"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-294"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679463995"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#unboundedVertexId"><span class="hs-identifier hs-var">unboundedVertexId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((p ~ (-&gt;)) =&gt;
 (Either (UnboundedVertex plane) (BoundedVertex plane)
  -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
 -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane))
-&gt; (p (Either (UnboundedVertex plane) (BoundedVertex plane))
      (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
    -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane))
-&gt; p (Either (UnboundedVertex plane) (BoundedVertex plane))
     (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane
-&gt; f (LowerEnvelope' plane)
forall (p :: * -&gt; * -&gt; *) (q :: * -&gt; * -&gt; *) a b r.
Conjoined p =&gt;
((p ~ (-&gt;)) =&gt; q (a -&gt; b) r) -&gt; q (p a b) r -&gt; q (p a b) r
forall (q :: * -&gt; * -&gt; *) a b r.
((p ~ (-&gt;)) =&gt; q (a -&gt; b) r) -&gt; q (p a b) r -&gt; q (p a b) r
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Internal.Indexed.html#conjoined"><span class="hs-identifier hs-var">conjoined</span></a></span><span> </span><span class="annot"><span class="annottext">(p ~ (-&gt;)) =&gt;
(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
forall {f :: * -&gt; *} {plane} {b} {b}.
Functor f =&gt;
(Either (UnboundedVertex plane) b
 -&gt; f (Either (UnboundedVertex plane) b))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="#local-6989586621679463997"><span class="hs-identifier hs-var">trav0</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int
 -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
(Int
 -&gt; Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
forall (f :: * -&gt; *).
Applicative f =&gt;
(Int
 -&gt; Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="#local-6989586621679464000"><span class="hs-identifier hs-var">itrav0</span></a></span><span> </span><span class="annot"><span class="annottext">((Int
  -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
  -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
 -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane))
-&gt; (p (Either (UnboundedVertex plane) (BoundedVertex plane))
      (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
    -&gt; Int
    -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
    -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; p (Either (UnboundedVertex plane) (BoundedVertex plane))
     (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane
-&gt; f (LowerEnvelope' plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">p (Either (UnboundedVertex plane) (BoundedVertex plane))
  (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; Int
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
forall a b. p a b -&gt; Int -&gt; a -&gt; b
forall i (p :: * -&gt; * -&gt; *) a b.
Indexable i p =&gt;
p a b -&gt; i -&gt; a -&gt; b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Internal.Indexed.html#indexed"><span class="hs-identifier hs-var">indexed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((p ~ (-&gt;)) =&gt;
 (Either (UnboundedVertex plane) (BoundedVertex plane)
  -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
 -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane))
-&gt; (p (Either (UnboundedVertex plane) (BoundedVertex plane))
      (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
    -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane))
-&gt; p (Either (UnboundedVertex plane) (BoundedVertex plane))
     (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane
-&gt; f (LowerEnvelope' plane)
forall (p :: * -&gt; * -&gt; *) (q :: * -&gt; * -&gt; *) a b r.
Conjoined p =&gt;
((p ~ (-&gt;)) =&gt; q (a -&gt; b) r) -&gt; q (p a b) r -&gt; q (p a b) r
forall (q :: * -&gt; * -&gt; *) a b r.
((p ~ (-&gt;)) =&gt; q (a -&gt; b) r) -&gt; q (p a b) r -&gt; q (p a b) r
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Internal.Indexed.html#conjoined"><span class="hs-identifier hs-var">conjoined</span></a></span><span> </span><span class="annot"><span class="annottext">(p ~ (-&gt;)) =&gt;
(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
(Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
forall (f :: * -&gt; *).
Applicative f =&gt;
(Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="#local-6989586621679464002"><span class="hs-identifier hs-var">travVs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int
 -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="#local-6989586621679464005"><span class="hs-identifier hs-var">itravVs</span></a></span><span class="annot"><span class="annottext">((Int
  -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
  -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
 -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane))
-&gt; (p (Either (UnboundedVertex plane) (BoundedVertex plane))
      (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
    -&gt; Int
    -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
    -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; p (Either (UnboundedVertex plane) (BoundedVertex plane))
     (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane
-&gt; f (LowerEnvelope' plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">p (Either (UnboundedVertex plane) (BoundedVertex plane))
  (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; Int
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
forall a b. p a b -&gt; Int -&gt; a -&gt; b
forall i (p :: * -&gt; * -&gt; *) a b.
Indexable i p =&gt;
p a b -&gt; i -&gt; a -&gt; b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Internal.Indexed.html#indexed"><span class="hs-identifier hs-var">indexed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>      </span><span id="local-6989586621679463997"><span class="annot"><span class="annottext">trav0 :: (Either (UnboundedVertex plane) b
 -&gt; f (Either (UnboundedVertex plane) b))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="#local-6989586621679463997"><span class="hs-identifier hs-var hs-var">trav0</span></a></span></span><span>  </span><span id="local-6989586621679464008"><span class="annot"><span class="annottext">Either (UnboundedVertex plane) b
-&gt; f (Either (UnboundedVertex plane) b)
</span><a href="#local-6989586621679464008"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span id="local-6989586621679464009"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464009"><span class="hs-identifier hs-var">v0</span></a></span></span><span> </span><span id="local-6989586621679464010"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464010"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UnboundedVertex plane
 -&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane)
-&gt; Seq (BoundedVertex plane)
-&gt; UnboundedVertex plane
-&gt; LowerEnvelope' plane
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464010"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">(UnboundedVertex plane -&gt; LowerEnvelope' plane)
-&gt; (Either (UnboundedVertex plane) b -&gt; UnboundedVertex plane)
-&gt; Either (UnboundedVertex plane) b
-&gt; LowerEnvelope' plane
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane) b -&gt; UnboundedVertex plane
forall {c} {b}. Either c b -&gt; c
</span><a href="#local-6989586621679464012"><span class="hs-identifier hs-var">unLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane) b -&gt; LowerEnvelope' plane)
-&gt; f (Either (UnboundedVertex plane) b) -&gt; f (LowerEnvelope' plane)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane) b
-&gt; f (Either (UnboundedVertex plane) b)
</span><a href="#local-6989586621679464008"><span class="hs-identifier hs-var">f</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnboundedVertex plane -&gt; Either (UnboundedVertex plane) b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464009"><span class="hs-identifier hs-var">v0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>      </span><span id="local-6989586621679462773"><span class="annot"><a href="#local-6989586621679464000"><span class="hs-identifier hs-type">itrav0</span></a></span><span>                          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679462773"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-300"></span><span>                                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>                                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462773"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462773"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-303"></span><span>      </span><span id="local-6989586621679464000"><span class="annot"><span class="annottext">itrav0 :: forall (f :: * -&gt; *).
Applicative f =&gt;
(Int
 -&gt; Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="#local-6989586621679464000"><span class="hs-identifier hs-var hs-var">itrav0</span></a></span></span><span> </span><span id="local-6989586621679464016"><span class="annot"><span class="annottext">Int
-&gt; Vertex (LowerEnvelope' plane)
-&gt; f (Vertex (LowerEnvelope' plane))
</span><a href="#local-6989586621679464016"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span id="local-6989586621679464017"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464017"><span class="hs-identifier hs-var">v0</span></a></span></span><span> </span><span id="local-6989586621679464018"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464018"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UnboundedVertex plane
 -&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane)
-&gt; Seq (BoundedVertex plane)
-&gt; UnboundedVertex plane
-&gt; LowerEnvelope' plane
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464018"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">(UnboundedVertex plane -&gt; LowerEnvelope' plane)
-&gt; (Either (UnboundedVertex plane) (BoundedVertex plane)
    -&gt; UnboundedVertex plane)
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; LowerEnvelope' plane
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; UnboundedVertex plane
forall {c} {b}. Either c b -&gt; c
</span><a href="#local-6989586621679464012"><span class="hs-identifier hs-var">unLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; LowerEnvelope' plane)
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
-&gt; f (LowerEnvelope' plane)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Vertex (LowerEnvelope' plane)
-&gt; f (Vertex (LowerEnvelope' plane))
</span><a href="#local-6989586621679464016"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464017"><span class="hs-identifier hs-var">v0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>      </span><span id="local-6989586621679462776"><span class="annot"><a href="#local-6989586621679464002"><span class="hs-identifier hs-type">travVs</span></a></span><span>                          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679462776"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-306"></span><span>                                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>                                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462776"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462776"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462754"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-309"></span><span>      </span><span id="local-6989586621679464002"><span class="annot"><span class="annottext">travVs :: forall (f :: * -&gt; *).
Applicative f =&gt;
(Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="#local-6989586621679464002"><span class="hs-identifier hs-var hs-var">travVs</span></a></span></span><span> </span><span id="local-6989586621679464027"><span class="annot"><span class="annottext">Vertex (LowerEnvelope' plane) -&gt; f (Vertex (LowerEnvelope' plane))
</span><a href="#local-6989586621679464027"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span id="local-6989586621679464028"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464028"><span class="hs-identifier hs-var">v0</span></a></span></span><span> </span><span id="local-6989586621679464029"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464029"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464028"><span class="hs-identifier hs-var">v0</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane)
-&gt; f (Seq (BoundedVertex plane)) -&gt; f (LowerEnvelope' plane)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464029"><span class="hs-identifier hs-var">vs</span></a></span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
-&gt; (Seq (BoundedVertex plane) -&gt; f (Seq (BoundedVertex plane)))
-&gt; f (Seq (BoundedVertex plane))
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">Index (Seq (BoundedVertex plane))
-&gt; Traversal'
     (Seq (BoundedVertex plane)) (IxValue (Seq (BoundedVertex plane)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.At.html#ix"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679463995"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((BoundedVertex plane -&gt; f (BoundedVertex plane))
 -&gt; Seq (BoundedVertex plane) -&gt; f (Seq (BoundedVertex plane)))
-&gt; (BoundedVertex plane -&gt; f (BoundedVertex plane))
-&gt; Seq (BoundedVertex plane)
-&gt; f (Seq (BoundedVertex plane))
forall {k} (f :: k -&gt; *) s (t :: k) a (b :: k).
LensLike f s t a b -&gt; LensLike f s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Lens.html#%25%25~"><span class="hs-operator hs-var">%%~</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
-&gt; f (BoundedVertex plane)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; BoundedVertex plane
forall {a} {c}. Either a c -&gt; c
</span><a href="#local-6989586621679464032"><span class="hs-identifier hs-var">unRight</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Either (UnboundedVertex plane) (BoundedVertex plane))
 -&gt; f (BoundedVertex plane))
-&gt; (BoundedVertex plane
    -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; BoundedVertex plane
-&gt; f (BoundedVertex plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
Vertex (LowerEnvelope' plane) -&gt; f (Vertex (LowerEnvelope' plane))
</span><a href="#local-6989586621679464027"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; (BoundedVertex plane
    -&gt; Either (UnboundedVertex plane) (BoundedVertex plane))
-&gt; BoundedVertex plane
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BoundedVertex plane
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>      </span><span id="local-6989586621679464005"><span class="annot"><span class="annottext">itravVs :: (Int
 -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="#local-6989586621679464005"><span class="hs-identifier hs-var hs-var">itravVs</span></a></span></span><span> </span><span id="local-6989586621679464033"><span class="annot"><span class="annottext">Int
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
</span><a href="#local-6989586621679464033"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span id="local-6989586621679464034"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464034"><span class="hs-identifier hs-var">v0</span></a></span></span><span> </span><span id="local-6989586621679464035"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464035"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-312"></span><span>        </span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464034"><span class="hs-identifier hs-var">v0</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane)
-&gt; f (Seq (BoundedVertex plane)) -&gt; f (LowerEnvelope' plane)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464035"><span class="hs-identifier hs-var">vs</span></a></span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
-&gt; (Seq (BoundedVertex plane) -&gt; f (Seq (BoundedVertex plane)))
-&gt; f (Seq (BoundedVertex plane))
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">Index (Seq (BoundedVertex plane))
-&gt; Traversal'
     (Seq (BoundedVertex plane)) (IxValue (Seq (BoundedVertex plane)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.At.html#ix"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679463995"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((BoundedVertex plane -&gt; f (BoundedVertex plane))
 -&gt; Seq (BoundedVertex plane) -&gt; f (Seq (BoundedVertex plane)))
-&gt; (BoundedVertex plane -&gt; f (BoundedVertex plane))
-&gt; Seq (BoundedVertex plane)
-&gt; f (Seq (BoundedVertex plane))
forall {k} (f :: k -&gt; *) s (t :: k) a (b :: k).
LensLike f s t a b -&gt; LensLike f s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Lens.html#%25%25~"><span class="hs-operator hs-var">%%~</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
-&gt; f (BoundedVertex plane)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; BoundedVertex plane
forall {a} {c}. Either a c -&gt; c
</span><a href="#local-6989586621679464032"><span class="hs-identifier hs-var">unRight</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Either (UnboundedVertex plane) (BoundedVertex plane))
 -&gt; f (BoundedVertex plane))
-&gt; (BoundedVertex plane
    -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; BoundedVertex plane
-&gt; f (BoundedVertex plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
</span><a href="#local-6989586621679464033"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679463995"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; (BoundedVertex plane
    -&gt; Either (UnboundedVertex plane) (BoundedVertex plane))
-&gt; BoundedVertex plane
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BoundedVertex plane
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>      </span><span id="local-6989586621679464012"><span class="annot"><span class="annottext">unLeft :: Either c b -&gt; c
</span><a href="#local-6989586621679464012"><span class="hs-identifier hs-var hs-var">unLeft</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(c -&gt; c) -&gt; (b -&gt; c) -&gt; Either c b -&gt; c
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; c
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; b -&gt; c
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LowerEnvelope'.vertexAt: trying to convert v_infty into a normal vertex is not allowed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>      </span><span id="local-6989586621679464032"><span class="annot"><span class="annottext">unRight :: Either a c -&gt; c
</span><a href="#local-6989586621679464032"><span class="hs-identifier hs-var hs-var">unRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; c) -&gt; (c -&gt; c) -&gt; Either a c -&gt; c
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; a -&gt; c
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LowerEnvelope'.vertexAt: trying to convert a regular bounded vertex into v_infty is not allowed&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">c -&gt; c
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-pragma hs-type">vertexAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679462755"><span id="local-6989586621679462756"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#HasVertices"><span class="hs-identifier hs-type">HasVertices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462755"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462756"><span class="hs-identifier hs-type">plane'</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621679464053"><span class="annot"><span class="annottext">vertices :: IndexedTraversal1
  (VertexIx (LowerEnvelope' plane))
  (LowerEnvelope' plane)
  (LowerEnvelope' plane')
  (Vertex (LowerEnvelope' plane))
  (Vertex (LowerEnvelope' plane'))
</span><a href="#local-6989586621679464053"><span class="hs-identifier hs-var hs-var hs-var hs-var">vertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((p ~ (-&gt;)) =&gt;
 (Either (UnboundedVertex plane) (BoundedVertex plane)
  -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
 -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane'))
-&gt; (p (Either (UnboundedVertex plane) (BoundedVertex plane))
      (f (Either (UnboundedVertex plane') (BoundedVertex plane')))
    -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane'))
-&gt; p (Either (UnboundedVertex plane) (BoundedVertex plane))
     (f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; LowerEnvelope' plane
-&gt; f (LowerEnvelope' plane')
forall (p :: * -&gt; * -&gt; *) (q :: * -&gt; * -&gt; *) a b r.
Conjoined p =&gt;
((p ~ (-&gt;)) =&gt; q (a -&gt; b) r) -&gt; q (p a b) r -&gt; q (p a b) r
forall (q :: * -&gt; * -&gt; *) a b r.
((p ~ (-&gt;)) =&gt; q (a -&gt; b) r) -&gt; q (p a b) r -&gt; q (p a b) r
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Internal.Indexed.html#conjoined"><span class="hs-identifier hs-var">conjoined</span></a></span><span> </span><span class="annot"><span class="annottext">(p ~ (-&gt;)) =&gt;
(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane')
(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane')
(Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane')))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane')
forall (f :: * -&gt; *).
Apply f =&gt;
(Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane')))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane')
</span><a href="#local-6989586621679464055"><span class="hs-identifier hs-var">traverse'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int
 -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane')
(Int
 -&gt; Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane')))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane')
forall (f :: * -&gt; *).
Apply f =&gt;
(Int
 -&gt; Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane')))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane')
</span><a href="#local-6989586621679464058"><span class="hs-identifier hs-var">itraverse'</span></a></span><span> </span><span class="annot"><span class="annottext">((Int
  -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
  -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
 -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane'))
-&gt; (p (Either (UnboundedVertex plane) (BoundedVertex plane))
      (f (Either (UnboundedVertex plane') (BoundedVertex plane')))
    -&gt; Int
    -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
    -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; p (Either (UnboundedVertex plane) (BoundedVertex plane))
     (f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; LowerEnvelope' plane
-&gt; f (LowerEnvelope' plane')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">p (Either (UnboundedVertex plane) (BoundedVertex plane))
  (f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; Int
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
forall a b. p a b -&gt; Int -&gt; a -&gt; b
forall i (p :: * -&gt; * -&gt; *) a b.
Indexable i p =&gt;
p a b -&gt; i -&gt; a -&gt; b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Internal.Indexed.html#indexed"><span class="hs-identifier hs-var">indexed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>      </span><span id="local-6989586621679462810"><span class="annot"><a href="#local-6989586621679464055"><span class="hs-identifier hs-type">traverse'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462810"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462755"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462810"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462756"><span class="hs-identifier hs-type">plane'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462755"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462810"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462756"><span class="hs-identifier hs-type">plane'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-326"></span><span>      </span><span id="local-6989586621679464055"><span class="annot"><span class="annottext">traverse' :: forall (f :: * -&gt; *).
Apply f =&gt;
(Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane')))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane')
</span><a href="#local-6989586621679464055"><span class="hs-identifier hs-var hs-var">traverse'</span></a></span></span><span>  </span><span id="local-6989586621679464068"><span class="annot"><span class="annottext">Vertex (LowerEnvelope' plane) -&gt; f (Vertex (LowerEnvelope' plane'))
</span><a href="#local-6989586621679464068"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span id="local-6989586621679464069"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464069"><span class="hs-identifier hs-var">v0</span></a></span></span><span> </span><span id="local-6989586621679464070"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464070"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-327"></span><span>        </span><span class="annot"><span class="annottext">UnboundedVertex plane'
-&gt; Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane'
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">(UnboundedVertex plane'
 -&gt; Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane')
-&gt; f (UnboundedVertex plane')
-&gt; f (Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane') (BoundedVertex plane')
 -&gt; UnboundedVertex plane')
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
-&gt; f (UnboundedVertex plane')
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane') (BoundedVertex plane')
-&gt; UnboundedVertex plane'
forall {c} {b}. Either c b -&gt; c
</span><a href="#local-6989586621679464071"><span class="hs-identifier hs-var">unLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Either (UnboundedVertex plane') (BoundedVertex plane'))
 -&gt; f (UnboundedVertex plane'))
-&gt; (UnboundedVertex plane
    -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; UnboundedVertex plane
-&gt; f (UnboundedVertex plane')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
Vertex (LowerEnvelope' plane) -&gt; f (Vertex (LowerEnvelope' plane'))
</span><a href="#local-6989586621679464068"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; (UnboundedVertex plane
    -&gt; Either (UnboundedVertex plane) (BoundedVertex plane))
-&gt; UnboundedVertex plane
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464069"><span class="hs-identifier hs-var">v0</span></a></span><span>
</span><span id="line-328"></span><span>                      </span><span class="annot"><span class="annottext">f (Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane')
-&gt; MaybeApply f (Seq (BoundedVertex plane'))
-&gt; f (LowerEnvelope' plane')
forall (f :: * -&gt; *) a b.
Apply f =&gt;
f (a -&gt; b) -&gt; MaybeApply f a -&gt; f b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#%3C.%2A%3E"><span class="hs-operator hs-var">&lt;.*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(BoundedVertex plane -&gt; f (BoundedVertex plane'))
-&gt; Seq (BoundedVertex plane)
-&gt; MaybeApply f (Seq (BoundedVertex plane'))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Apply f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; MaybeApply f (t b)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#traverse1Maybe"><span class="hs-identifier hs-var">traverse1Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane') (BoundedVertex plane')
 -&gt; BoundedVertex plane')
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
-&gt; f (BoundedVertex plane')
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane') (BoundedVertex plane')
-&gt; BoundedVertex plane'
forall {a} {c}. Either a c -&gt; c
</span><a href="#local-6989586621679464072"><span class="hs-identifier hs-var">unRight</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Either (UnboundedVertex plane') (BoundedVertex plane'))
 -&gt; f (BoundedVertex plane'))
-&gt; (BoundedVertex plane
    -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; BoundedVertex plane
-&gt; f (BoundedVertex plane')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
Vertex (LowerEnvelope' plane) -&gt; f (Vertex (LowerEnvelope' plane'))
</span><a href="#local-6989586621679464068"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; (BoundedVertex plane
    -&gt; Either (UnboundedVertex plane) (BoundedVertex plane))
-&gt; BoundedVertex plane
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BoundedVertex plane
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464070"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>      </span><span id="local-6989586621679464071"><span class="annot"><span class="annottext">unLeft :: Either c b -&gt; c
</span><a href="#local-6989586621679464071"><span class="hs-identifier hs-var hs-var">unLeft</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(c -&gt; c) -&gt; (b -&gt; c) -&gt; Either c b -&gt; c
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; c
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; b -&gt; c
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LowerEnvelope'.vertices: trying to convert v_infty into a normal vertex is not allowed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>      </span><span id="local-6989586621679464072"><span class="annot"><span class="annottext">unRight :: Either a c -&gt; c
</span><a href="#local-6989586621679464072"><span class="hs-identifier hs-var hs-var">unRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; c) -&gt; (c -&gt; c) -&gt; Either a c -&gt; c
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; a -&gt; c
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LowerEnvelope'.vertices: trying to convert a regular bounded vertex into v_infty is not allowed&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">c -&gt; c
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>      </span><span id="local-6989586621679462811"><span class="annot"><a href="#local-6989586621679464058"><span class="hs-identifier hs-type">itraverse'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462811"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462755"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462811"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462756"><span class="hs-identifier hs-type">plane'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462755"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462811"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462756"><span class="hs-identifier hs-type">plane'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-336"></span><span>      </span><span id="local-6989586621679464058"><span class="annot"><span class="annottext">itraverse' :: forall (f :: * -&gt; *).
Apply f =&gt;
(Int
 -&gt; Vertex (LowerEnvelope' plane)
 -&gt; f (Vertex (LowerEnvelope' plane')))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane')
</span><a href="#local-6989586621679464058"><span class="hs-identifier hs-var hs-var">itraverse'</span></a></span></span><span> </span><span id="local-6989586621679464088"><span class="annot"><span class="annottext">Int
-&gt; Vertex (LowerEnvelope' plane)
-&gt; f (Vertex (LowerEnvelope' plane'))
</span><a href="#local-6989586621679464088"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span id="local-6989586621679464089"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464089"><span class="hs-identifier hs-var">v0</span></a></span></span><span> </span><span id="local-6989586621679464090"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464090"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-337"></span><span>        </span><span class="annot"><span class="annottext">UnboundedVertex plane'
-&gt; Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane'
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">(UnboundedVertex plane'
 -&gt; Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane')
-&gt; f (UnboundedVertex plane')
-&gt; f (Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane') (BoundedVertex plane')
 -&gt; UnboundedVertex plane')
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
-&gt; f (UnboundedVertex plane')
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane') (BoundedVertex plane')
-&gt; UnboundedVertex plane'
forall {c} {b}. Either c b -&gt; c
</span><a href="#local-6989586621679464071"><span class="hs-identifier hs-var">unLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Either (UnboundedVertex plane') (BoundedVertex plane'))
 -&gt; f (UnboundedVertex plane'))
-&gt; (UnboundedVertex plane
    -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; UnboundedVertex plane
-&gt; f (UnboundedVertex plane')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Vertex (LowerEnvelope' plane)
-&gt; f (Vertex (LowerEnvelope' plane'))
</span><a href="#local-6989586621679464088"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#unboundedVertexId"><span class="hs-identifier hs-var">unboundedVertexId</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; (UnboundedVertex plane
    -&gt; Either (UnboundedVertex plane) (BoundedVertex plane))
-&gt; UnboundedVertex plane
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464089"><span class="hs-identifier hs-var">v0</span></a></span><span>
</span><span id="line-338"></span><span>                      </span><span class="annot"><span class="annottext">f (Seq (BoundedVertex plane') -&gt; LowerEnvelope' plane')
-&gt; MaybeApply f (Seq (BoundedVertex plane'))
-&gt; f (LowerEnvelope' plane')
forall (f :: * -&gt; *) a b.
Apply f =&gt;
f (a -&gt; b) -&gt; MaybeApply f a -&gt; f b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#%3C.%2A%3E"><span class="hs-operator hs-var">&lt;.*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; BoundedVertex plane -&gt; f (BoundedVertex plane'))
-&gt; Seq (BoundedVertex plane)
-&gt; MaybeApply f (Seq (BoundedVertex plane'))
forall i (t :: * -&gt; *) (f :: * -&gt; *) a b.
(TraversableWithIndex i t, Apply f) =&gt;
(i -&gt; a -&gt; f b) -&gt; t a -&gt; MaybeApply f (t b)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#itraverse1Maybe"><span class="hs-identifier hs-var">itraverse1Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679464092"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464092"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane') (BoundedVertex plane')
 -&gt; BoundedVertex plane')
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
-&gt; f (BoundedVertex plane')
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Either (UnboundedVertex plane') (BoundedVertex plane')
-&gt; BoundedVertex plane'
forall {a} {c}. Either a c -&gt; c
</span><a href="#local-6989586621679464072"><span class="hs-identifier hs-var">unRight</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Either (UnboundedVertex plane') (BoundedVertex plane'))
 -&gt; f (BoundedVertex plane'))
-&gt; (BoundedVertex plane
    -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; BoundedVertex plane
-&gt; f (BoundedVertex plane')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Vertex (LowerEnvelope' plane)
-&gt; f (Vertex (LowerEnvelope' plane'))
</span><a href="#local-6989586621679464088"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464092"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either (UnboundedVertex plane) (BoundedVertex plane)
 -&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane')))
-&gt; (BoundedVertex plane
    -&gt; Either (UnboundedVertex plane) (BoundedVertex plane))
-&gt; BoundedVertex plane
-&gt; f (Either (UnboundedVertex plane') (BoundedVertex plane'))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BoundedVertex plane
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464090"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertices"><span class="hs-pragma hs-type">vertices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="annot"><span class="hs-comment">-- | Indexed version of 'traverse1Maybe'.</span></span><span>
</span><span id="line-342"></span><span id="local-6989586621679462828"><span id="local-6989586621679462829"><span id="local-6989586621679462830"><span id="local-6989586621679462831"><span id="local-6989586621679462832"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#itraverse1Maybe"><span class="hs-identifier hs-type">itraverse1Maybe</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/indexed-traversable-0.1.4-d0bcc25dfc500bdfa17dfbfab47433d9c5a2ccbcfda5ee129e7c72c1388a4613/share/doc/html/src/WithIndex.html#TraversableWithIndex"><span class="hs-identifier hs-type">TraversableWithIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462828"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462829"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462830"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679462828"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462831"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462830"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462832"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462829"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462831"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#MaybeApply"><span class="hs-identifier hs-type">Apply.MaybeApply</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462830"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679462829"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462832"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-344"></span><span id="itraverse1Maybe"><span class="annot"><span class="annottext">itraverse1Maybe :: forall i (t :: * -&gt; *) (f :: * -&gt; *) a b.
(TraversableWithIndex i t, Apply f) =&gt;
(i -&gt; a -&gt; f b) -&gt; t a -&gt; MaybeApply f (t b)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#itraverse1Maybe"><span class="hs-identifier hs-var hs-var">itraverse1Maybe</span></a></span></span><span> </span><span id="local-6989586621679464098"><span class="annot"><span class="annottext">i -&gt; a -&gt; f b
</span><a href="#local-6989586621679464098"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i -&gt; a -&gt; MaybeApply f b) -&gt; t a -&gt; MaybeApply f (t b)
forall i (t :: * -&gt; *) (f :: * -&gt; *) a b.
(TraversableWithIndex i t, Applicative f) =&gt;
(i -&gt; a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(i -&gt; a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/indexed-traversable-0.1.4-d0bcc25dfc500bdfa17dfbfab47433d9c5a2ccbcfda5ee129e7c72c1388a4613/share/doc/html/src/WithIndex.html#itraverse"><span class="hs-identifier hs-var">itraverse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679464100"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679464100"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (f b) b -&gt; MaybeApply f b
forall (f :: * -&gt; *) a. Either (f a) a -&gt; MaybeApply f a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/semigroupoids-6.0.1-aa416192a766e4896bc49204f60523faac67d282183ad0e279d538496f49c17c/share/doc/html/src/Data.Functor.Bind.Class.html#MaybeApply"><span class="hs-identifier hs-var">Apply.MaybeApply</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (f b) b -&gt; MaybeApply f b)
-&gt; (a -&gt; Either (f b) b) -&gt; a -&gt; MaybeApply f b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f b -&gt; Either (f b) b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(f b -&gt; Either (f b) b) -&gt; (a -&gt; f b) -&gt; a -&gt; Either (f b) b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; a -&gt; f b
</span><a href="#local-6989586621679464098"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679464100"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679462852"><span id="local-6989586621679464104"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#HasDarts%27"><span class="hs-identifier hs-type">HasDarts'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462852"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Dart"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Dart"><span class="hs-identifier hs-var">Dart</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462852"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462852"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DartIx"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#DartIx"><span class="hs-identifier hs-var">DartIx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462852"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462852"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462852"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>                                       </span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679464136"><span class="annot"><span class="annottext">dartAt :: DartIx (LowerEnvelope' plane)
-&gt; IndexedTraversal'
     (DartIx (LowerEnvelope' plane))
     (LowerEnvelope' plane)
     (Dart (LowerEnvelope' plane))
</span><a href="#local-6989586621679464136"><span class="hs-identifier hs-var hs-var hs-var hs-var">dartAt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464138"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464138"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679464139"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464139"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexIx (LowerEnvelope' plane)
-&gt; IndexedTraversal'
     (VertexIx (LowerEnvelope' plane))
     (LowerEnvelope' plane)
     (Vertex (LowerEnvelope' plane))
forall graph.
HasVertices' graph =&gt;
VertexIx graph
-&gt; IndexedTraversal' (VertexIx graph) graph (Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-var">vertexAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
VertexIx (LowerEnvelope' plane)
</span><a href="#local-6989586621679464138"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">(Indexed
   Int
   (Either (UnboundedVertex plane) (BoundedVertex plane))
   (f (Either (UnboundedVertex plane) (BoundedVertex plane)))
 -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane))
-&gt; (Indexed Int (LEEdge plane) (f (LEEdge plane))
    -&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
    -&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane)))
-&gt; p (LEEdge plane) (f (LEEdge plane))
-&gt; LowerEnvelope' plane
-&gt; f (LowerEnvelope' plane)
forall i j (p :: * -&gt; * -&gt; *) s t r a b.
Indexable (i, j) p =&gt;
(Indexed i s t -&gt; r) -&gt; (Indexed j a b -&gt; s -&gt; t) -&gt; p a b -&gt; r
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Indexed.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Optical
  (Indexed Int)
  (-&gt;)
  f
  (UnboundedVertex plane)
  (UnboundedVertex plane)
  (LEEdge plane)
  (LEEdge plane)
-&gt; Optical
     (Indexed Int)
     (-&gt;)
     f
     (BoundedVertex plane)
     (BoundedVertex plane)
     (LEEdge plane)
     (LEEdge plane)
-&gt; Indexed Int (LEEdge plane) (f (LEEdge plane))
-&gt; Either (UnboundedVertex plane) (BoundedVertex plane)
-&gt; f (Either (UnboundedVertex plane) (BoundedVertex plane))
forall (q :: * -&gt; * -&gt; *) (f :: * -&gt; *) (r :: * -&gt; * -&gt; *)
       (p :: * -&gt; * -&gt; *) s t a b s' t'.
(Representable q, Applicative (Rep q), Applicative f,
 Bitraversable r) =&gt;
Optical p q f s t a b
-&gt; Optical p q f s' t' a b -&gt; Optical p q f (r s s') (r t t') a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Traversal.html#beside"><span class="hs-identifier hs-var">beside</span></a></span><span> </span><span class="annot"><span class="annottext">Optical
  (Indexed Int)
  (-&gt;)
  f
  (UnboundedVertex plane)
  (UnboundedVertex plane)
  (LEEdge plane)
  (LEEdge plane)
forall (t :: * -&gt; *).
HasIncidentEdges t =&gt;
IndexedTraversal' Int (t plane) (LEEdge plane)
IndexedTraversal' Int (UnboundedVertex plane) (LEEdge plane)
</span><a href="#local-6989586621679464142"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Optical
  (Indexed Int)
  (-&gt;)
  f
  (BoundedVertex plane)
  (BoundedVertex plane)
  (LEEdge plane)
  (LEEdge plane)
forall (t :: * -&gt; *).
HasIncidentEdges t =&gt;
IndexedTraversal' Int (t plane) (LEEdge plane)
IndexedTraversal' Int (BoundedVertex plane) (LEEdge plane)
</span><a href="#local-6989586621679464142"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>      </span><span id="local-6989586621679462881"><span class="annot"><a href="#local-6989586621679464142"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#HasIncidentEdges"><span class="hs-identifier hs-type">HasIncidentEdges</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462881"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Type.html#IndexedTraversal%27"><span class="hs-identifier hs-type">IndexedTraversal'</span></a></span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679462881"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462852"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462852"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-356"></span><span>      </span><span id="local-6989586621679464142"><span class="annot"><span class="annottext">l :: forall (t :: * -&gt; *).
HasIncidentEdges t =&gt;
IndexedTraversal' Int (t plane) (LEEdge plane)
</span><a href="#local-6989586621679464142"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
-&gt; t plane -&gt; f (t plane)
forall plane. Lens' (t plane) (Seq (LEEdge plane))
forall (t :: * -&gt; *) plane.
HasIncidentEdges t =&gt;
Lens' (t plane) (Seq (LEEdge plane))
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#incidentEdges%27"><span class="hs-identifier hs-var">incidentEdges'</span></a></span><span> </span><span class="annot"><span class="annottext">((Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
 -&gt; t plane -&gt; f (t plane))
-&gt; (p (LEEdge plane) (f (LEEdge plane))
    -&gt; Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
-&gt; p (LEEdge plane) (f (LEEdge plane))
-&gt; t plane
-&gt; f (t plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Indexed.html#.%3E"><span class="hs-operator hs-var">.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (LEEdge plane -&gt; Int)
-&gt; IndexedTraversal' Int (Seq (LEEdge plane)) (LEEdge plane)
forall i a. Eq i =&gt; i -&gt; (a -&gt; i) -&gt; IndexedTraversal' i (Seq a) a
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#first%27"><span class="hs-identifier hs-var">first'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464139"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Int (LEEdge plane) Int -&gt; LEEdge plane -&gt; Int
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Int (LEEdge plane) Int
forall plane (f :: * -&gt; *).
(Contravariant f, Functor f) =&gt;
(Int -&gt; f Int) -&gt; LEEdge plane -&gt; f (LEEdge plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#destination"><span class="hs-identifier hs-var">destination</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#dartAt"><span class="hs-pragma hs-type">dartAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><span class="hs-comment">-- | Helper function to access the an edge</span></span><span>
</span><span id="line-360"></span><span id="local-6989586621679462887"><span id="local-6989586621679462888"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#first%27"><span class="hs-identifier hs-type">first'</span></a></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679462887"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462887"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679462888"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462887"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Type.html#IndexedTraversal%27"><span class="hs-identifier hs-type">IndexedTraversal'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462887"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679462888"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679462888"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-362"></span><span id="first%27"><span class="annot"><span class="annottext">first' :: forall i a. Eq i =&gt; i -&gt; (a -&gt; i) -&gt; IndexedTraversal' i (Seq a) a
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#first%27"><span class="hs-identifier hs-var hs-var">first'</span></a></span></span><span> </span><span id="local-6989586621679464167"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679464167"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679464168"><span class="annot"><span class="annottext">a -&gt; i
</span><a href="#local-6989586621679464168"><span class="hs-identifier hs-var">getIdx</span></a></span></span><span> </span><span id="local-6989586621679464169"><span class="annot"><span class="annottext">p a (f a)
</span><a href="#local-6989586621679464169"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679464170"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679464170"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Seq a -&gt; Maybe Int
forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">Seq.findIndexL</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679464167"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(i -&gt; Bool) -&gt; (a -&gt; i) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; i
</span><a href="#local-6989586621679464168"><span class="hs-identifier hs-var">getIdx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679464170"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-363"></span><span>                        </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq a -&gt; f (Seq a)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679464170"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-364"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679464172"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464172"><span class="hs-identifier hs-var">j</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679464170"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Seq a -&gt; (Seq a -&gt; f (Seq a)) -&gt; f (Seq a)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">Index (Seq a) -&gt; Traversal' (Seq a) (IxValue (Seq a))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.At.html#ix"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
Index (Seq a)
</span><a href="#local-6989586621679464172"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; f a) -&gt; Seq a -&gt; f (Seq a))
-&gt; (a -&gt; f a) -&gt; Seq a -&gt; f (Seq a)
forall {k} (f :: k -&gt; *) s (t :: k) a (b :: k).
LensLike f s t a b -&gt; LensLike f s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Lens.html#%25%25~"><span class="hs-operator hs-var">%%~</span></a></span><span> </span><span class="annot"><span class="annottext">p a (f a) -&gt; i -&gt; a -&gt; f a
forall a b. p a b -&gt; i -&gt; a -&gt; b
forall i (p :: * -&gt; * -&gt; *) a b.
Indexable i p =&gt;
p a b -&gt; i -&gt; a -&gt; b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Internal.Indexed.html#indexed"><span class="hs-identifier hs-var">indexed</span></a></span><span> </span><span class="annot"><span class="annottext">p a (f a)
</span><a href="#local-6989586621679464169"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679464167"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679462853"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#HasDarts"><span class="hs-identifier hs-type">HasDarts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621679464182"><span class="annot"><span class="annottext">darts :: IndexedTraversal
  (DartIx (LowerEnvelope' plane))
  (LowerEnvelope' plane)
  (LowerEnvelope' plane)
  (Dart (LowerEnvelope' plane))
  (Dart (LowerEnvelope' plane))
</span><a href="#local-6989586621679464182"><span class="hs-identifier hs-var hs-var hs-var hs-var">darts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; LEEdge plane -&gt; f (LEEdge plane))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
(DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
forall (f :: * -&gt; *).
Applicative f =&gt;
(DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="#local-6989586621679464184"><span class="hs-identifier hs-var">itraverse'</span></a></span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; LEEdge plane -&gt; f (LEEdge plane))
 -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane))
-&gt; (p (LEEdge plane) (f (LEEdge plane))
    -&gt; (Int, Int) -&gt; LEEdge plane -&gt; f (LEEdge plane))
-&gt; p (LEEdge plane) (f (LEEdge plane))
-&gt; LowerEnvelope' plane
-&gt; f (LowerEnvelope' plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">p (LEEdge plane) (f (LEEdge plane))
-&gt; (Int, Int) -&gt; LEEdge plane -&gt; f (LEEdge plane)
forall a b. p a b -&gt; (Int, Int) -&gt; a -&gt; b
forall i (p :: * -&gt; * -&gt; *) a b.
Indexable i p =&gt;
p a b -&gt; i -&gt; a -&gt; b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Internal.Indexed.html#indexed"><span class="hs-identifier hs-var">indexed</span></a></span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-comment">-- the traverse' variant that does not use the indices does not really look all that</span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-comment">-- useful. So I didn't bother writing the faster version.</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>      </span><span id="local-6989586621679462903"><span class="annot"><a href="#local-6989586621679464184"><span class="hs-identifier hs-type">itraverse'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679462903"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#DartIx"><span class="hs-identifier hs-type">DartIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462903"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462903"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-375"></span><span>      </span><span id="local-6989586621679464184"><span class="annot"><span class="annottext">itraverse' :: forall (f :: * -&gt; *).
Applicative f =&gt;
(DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="#local-6989586621679464184"><span class="hs-identifier hs-var hs-var">itraverse'</span></a></span></span><span> </span><span id="local-6989586621679464200"><span class="annot"><span class="annottext">DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane)
</span><a href="#local-6989586621679464200"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-type">LowerEnvelope</span></a></span><span> </span><span id="local-6989586621679464201"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464201"><span class="hs-identifier hs-var">v0</span></a></span></span><span> </span><span id="local-6989586621679464202"><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464202"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
forall plane.
UnboundedVertex plane
-&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope"><span class="hs-identifier hs-var">LowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">(UnboundedVertex plane
 -&gt; Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane)
-&gt; f (UnboundedVertex plane)
-&gt; f (Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464201"><span class="hs-identifier hs-var">v0</span></a></span><span class="annot"><span class="annottext">UnboundedVertex plane
-&gt; (UnboundedVertex plane -&gt; f (UnboundedVertex plane))
-&gt; f (UnboundedVertex plane)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
-&gt; UnboundedVertex plane -&gt; f (UnboundedVertex plane)
forall plane plane' (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Profunctor p, Functor f) =&gt;
p (Seq (LEEdge plane)) (f (Seq (LEEdge plane')))
-&gt; p (UnboundedVertex plane) (f (UnboundedVertex plane'))
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#incidentEdgesU"><span class="hs-identifier hs-var">incidentEdgesU</span></a></span><span class="annot"><span class="annottext">((Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
 -&gt; UnboundedVertex plane -&gt; f (UnboundedVertex plane))
-&gt; ((LEEdge plane -&gt; f (LEEdge plane))
    -&gt; Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
-&gt; (LEEdge plane -&gt; f (LEEdge plane))
-&gt; UnboundedVertex plane
-&gt; f (UnboundedVertex plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(LEEdge plane -&gt; f (LEEdge plane))
-&gt; Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Seq a -&gt; f (Seq b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((LEEdge plane -&gt; f (LEEdge plane))
 -&gt; UnboundedVertex plane -&gt; f (UnboundedVertex plane))
-&gt; (LEEdge plane -&gt; f (LEEdge plane))
-&gt; UnboundedVertex plane
-&gt; f (UnboundedVertex plane)
forall {k} (f :: k -&gt; *) s (t :: k) a (b :: k).
LensLike f s t a b -&gt; LensLike f s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Lens.html#%25%25~"><span class="hs-operator hs-var">%%~</span></a></span><span> </span><span class="annot"><span class="annottext">(DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane))
-&gt; VertexIx (LowerEnvelope' plane)
-&gt; LEEdge plane
-&gt; f (LEEdge plane)
forall (f :: * -&gt; *).
(DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane))
-&gt; VertexIx (LowerEnvelope' plane)
-&gt; LEEdge plane
-&gt; f (LEEdge plane)
</span><a href="#local-6989586621679464203"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="annot"><span class="annottext">DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane)
</span><a href="#local-6989586621679464200"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
VertexIx (LowerEnvelope' plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#unboundedVertexId"><span class="hs-identifier hs-var">unboundedVertexId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>                      </span><span class="annot"><span class="annottext">f (Seq (BoundedVertex plane) -&gt; LowerEnvelope' plane)
-&gt; f (Seq (BoundedVertex plane)) -&gt; f (LowerEnvelope' plane)
forall a b. f (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; BoundedVertex plane -&gt; f (BoundedVertex plane))
-&gt; Seq (BoundedVertex plane) -&gt; f (Seq (BoundedVertex plane))
forall i (t :: * -&gt; *) (f :: * -&gt; *) a b.
(TraversableWithIndex i t, Applicative f) =&gt;
(i -&gt; a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(Int -&gt; a -&gt; f b) -&gt; Seq a -&gt; f (Seq b)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/indexed-traversable-0.1.4-d0bcc25dfc500bdfa17dfbfab47433d9c5a2ccbcfda5ee129e7c72c1388a4613/share/doc/html/src/WithIndex.html#itraverse"><span class="hs-identifier hs-var">itraverse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679464204"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464204"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679464205"><span class="annot"><span class="annottext">BoundedVertex plane
</span><a href="#local-6989586621679464205"><span class="hs-identifier hs-var">vtx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BoundedVertex plane
</span><a href="#local-6989586621679464205"><span class="hs-identifier hs-var">vtx</span></a></span><span class="annot"><span class="annottext">BoundedVertex plane
-&gt; (BoundedVertex plane -&gt; f (BoundedVertex plane))
-&gt; f (BoundedVertex plane)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
-&gt; BoundedVertex plane -&gt; f (BoundedVertex plane)
forall (f1 :: * -&gt; *) plane (g :: * -&gt; *) (f2 :: * -&gt; *).
Functor f2 =&gt;
(f1 (LEEdge plane) -&gt; f2 (g (LEEdge plane)))
-&gt; BoundedVertexF f1 plane -&gt; f2 (BoundedVertexF g plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#incidentEdgesB"><span class="hs-identifier hs-var">incidentEdgesB</span></a></span><span class="annot"><span class="annottext">((Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
 -&gt; BoundedVertex plane -&gt; f (BoundedVertex plane))
-&gt; ((LEEdge plane -&gt; f (LEEdge plane))
    -&gt; Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
-&gt; (LEEdge plane -&gt; f (LEEdge plane))
-&gt; BoundedVertex plane
-&gt; f (BoundedVertex plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(LEEdge plane -&gt; f (LEEdge plane))
-&gt; Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Seq a -&gt; f (Seq b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((LEEdge plane -&gt; f (LEEdge plane))
 -&gt; BoundedVertex plane -&gt; f (BoundedVertex plane))
-&gt; (LEEdge plane -&gt; f (LEEdge plane))
-&gt; BoundedVertex plane
-&gt; f (BoundedVertex plane)
forall {k} (f :: k -&gt; *) s (t :: k) a (b :: k).
LensLike f s t a b -&gt; LensLike f s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Lens.html#%25%25~"><span class="hs-operator hs-var">%%~</span></a></span><span> </span><span class="annot"><span class="annottext">(DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane))
-&gt; VertexIx (LowerEnvelope' plane)
-&gt; LEEdge plane
-&gt; f (LEEdge plane)
forall (f :: * -&gt; *).
(DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane))
-&gt; VertexIx (LowerEnvelope' plane)
-&gt; LEEdge plane
-&gt; f (LEEdge plane)
</span><a href="#local-6989586621679464203"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="annot"><span class="annottext">DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane)
</span><a href="#local-6989586621679464200"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464204"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (BoundedVertex plane)
</span><a href="#local-6989586621679464202"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>      </span><span id="local-6989586621679462905"><span class="annot"><a href="#local-6989586621679464203"><span class="hs-identifier hs-type">liftF</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#DartIx"><span class="hs-identifier hs-type">DartIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462905"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462905"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462853"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-382"></span><span>      </span><span id="local-6989586621679464203"><span class="annot"><span class="annottext">liftF :: forall (f :: * -&gt; *).
(DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane))
-&gt; VertexIx (LowerEnvelope' plane)
-&gt; LEEdge plane
-&gt; f (LEEdge plane)
</span><a href="#local-6989586621679464203"><span class="hs-identifier hs-var hs-var">liftF</span></a></span></span><span> </span><span id="local-6989586621679464208"><span class="annot"><span class="annottext">DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679464209"><span class="annot"><span class="annottext">VertexIx (LowerEnvelope' plane)
</span><a href="#local-6989586621679464209"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679464210"><span class="annot"><span class="annottext">LEEdge plane
</span><a href="#local-6989586621679464210"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DartIx (LowerEnvelope' plane) -&gt; LEEdge plane -&gt; f (LEEdge plane)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
VertexIx (LowerEnvelope' plane)
</span><a href="#local-6989586621679464209"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">LEEdge plane
</span><a href="#local-6989586621679464210"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">LEEdge plane -&gt; Getting Int (LEEdge plane) Int -&gt; Int
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting Int (LEEdge plane) Int
forall plane (f :: * -&gt; *).
(Contravariant f, Functor f) =&gt;
(Int -&gt; f Int) -&gt; LEEdge plane -&gt; f (LEEdge plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#destination"><span class="hs-identifier hs-var">destination</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LEEdge plane
</span><a href="#local-6989586621679464210"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#darts"><span class="hs-pragma hs-type">darts</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679462913"><span id="local-6989586621679464213"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#HasEdges%27"><span class="hs-identifier hs-type">HasEdges'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462913"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Edge"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Edge"><span class="hs-identifier hs-var">Edge</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462913"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462913"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="EdgeIx"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#EdgeIx"><span class="hs-identifier hs-var">EdgeIx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462913"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462913"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462913"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>                                       </span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>  </span><span id="local-6989586621679464220"><span class="annot"><span class="annottext">edgeAt :: EdgeIx (LowerEnvelope' plane)
-&gt; IndexedTraversal'
     (EdgeIx (LowerEnvelope' plane))
     (LowerEnvelope' plane)
     (Edge (LowerEnvelope' plane))
</span><a href="#local-6989586621679464220"><span class="hs-identifier hs-var hs-var hs-var hs-var">edgeAt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EdgeIx (LowerEnvelope' plane)
-&gt; IndexedTraversal'
     (EdgeIx (LowerEnvelope' plane))
     (LowerEnvelope' plane)
     (Edge (LowerEnvelope' plane))
DartIx (LowerEnvelope' plane)
-&gt; IndexedTraversal'
     (DartIx (LowerEnvelope' plane))
     (LowerEnvelope' plane)
     (Dart (LowerEnvelope' plane))
forall graph.
HasDarts' graph =&gt;
DartIx graph -&gt; IndexedTraversal' (DartIx graph) graph (Dart graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#dartAt"><span class="hs-identifier hs-var">dartAt</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#edgeAt"><span class="hs-pragma hs-type">edgeAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679462914"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#HasEdges"><span class="hs-identifier hs-type">HasEdges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462914"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462914"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-comment">-- | Traversal of all edges in the graph; i.e. we traverse the edges only in the</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-comment">-- direction from lower vertex id to higher vertexId.</span><span>
</span><span id="line-399"></span><span>  </span><span id="local-6989586621679464237"><span class="annot"><span class="annottext">edges :: IndexedTraversal
  (EdgeIx (LowerEnvelope' plane))
  (LowerEnvelope' plane)
  (LowerEnvelope' plane)
  (Edge (LowerEnvelope' plane))
  (Edge (LowerEnvelope' plane))
</span><a href="#local-6989586621679464237"><span class="hs-identifier hs-var hs-var hs-var hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Indexed
  (Int, Int)
  (Dart (LowerEnvelope' plane))
  (f (Dart (LowerEnvelope' plane)))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
Indexed (Int, Int) (LEEdge plane) (f (LEEdge plane))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
forall graph graph'.
HasDarts graph graph' =&gt;
IndexedTraversal
  (DartIx graph) graph graph' (Dart graph) (Dart graph')
IndexedTraversal
  (DartIx (LowerEnvelope' plane))
  (LowerEnvelope' plane)
  (LowerEnvelope' plane)
  (Dart (LowerEnvelope' plane))
  (Dart (LowerEnvelope' plane))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#darts"><span class="hs-identifier hs-var">darts</span></a></span><span> </span><span class="annot"><span class="annottext">(Indexed (Int, Int) (LEEdge plane) (f (LEEdge plane))
 -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane))
-&gt; (p (LEEdge plane) (f (LEEdge plane))
    -&gt; Indexed (Int, Int) (LEEdge plane) (f (LEEdge plane)))
-&gt; p (LEEdge plane) (f (LEEdge plane))
-&gt; LowerEnvelope' plane
-&gt; f (LowerEnvelope' plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; LEEdge plane -&gt; Bool)
-&gt; p (LEEdge plane) (f (LEEdge plane))
-&gt; Indexed (Int, Int) (LEEdge plane) (f (LEEdge plane))
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) a.
(Indexable i p, Applicative f) =&gt;
(i -&gt; a -&gt; Bool) -&gt; Optical' p (Indexed i) f a a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Fold.html#ifiltered"><span class="hs-identifier hs-var">ifiltered</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679464240"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464240"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679464241"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464241"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LEEdge plane
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464240"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464241"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#edges"><span class="hs-pragma hs-type">edges</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="hs-comment">-- instance Graph_ (LowerEnvelope' plane) where</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-keyword">class</span><span> </span><span id="HasUnboundedEdges"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#HasUnboundedEdges"><span class="hs-identifier hs-var">HasUnboundedEdges</span></a></span></span><span> </span><span id="local-6989586621679462927"><span class="annot"><a href="#local-6989586621679462927"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679462928"><span class="annot"><a href="#local-6989586621679462928"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679462927"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462928"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-comment">-- | Lens to access the unbounded edges.</span><span>
</span><span id="line-406"></span><span>  </span><span id="unboundedEdges"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#unboundedEdges"><span class="hs-identifier hs-type">unboundedEdges</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462927"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679462928"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679462929"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#HasUnboundedEdges"><span class="hs-identifier hs-type">HasUnboundedEdges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462929"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Type.html#LEEdge"><span class="hs-identifier hs-type">LEEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462929"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621679464250"><span class="annot"><span class="annottext">unboundedEdges :: Lens' (LowerEnvelope' plane) (Seq (LEEdge plane))
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#unboundedEdges"><span class="hs-identifier hs-var hs-var hs-var hs-var">unboundedEdges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UnboundedVertex plane -&gt; f (UnboundedVertex plane))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
forall plane (f :: * -&gt; *).
Functor f =&gt;
(UnboundedVertex plane -&gt; f (UnboundedVertex plane))
-&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#theUnboundedVertex"><span class="hs-identifier hs-var">theUnboundedVertex</span></a></span><span class="annot"><span class="annottext">((UnboundedVertex plane -&gt; f (UnboundedVertex plane))
 -&gt; LowerEnvelope' plane -&gt; f (LowerEnvelope' plane))
-&gt; ((Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
    -&gt; UnboundedVertex plane -&gt; f (UnboundedVertex plane))
-&gt; (Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
-&gt; LowerEnvelope' plane
-&gt; f (LowerEnvelope' plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Seq (LEEdge plane) -&gt; f (Seq (LEEdge plane)))
-&gt; UnboundedVertex plane -&gt; f (UnboundedVertex plane)
forall plane plane' (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Profunctor p, Functor f) =&gt;
p (Seq (LEEdge plane)) (f (Seq (LEEdge plane')))
-&gt; p (UnboundedVertex plane) (f (UnboundedVertex plane'))
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#incidentEdgesU"><span class="hs-identifier hs-var">incidentEdgesU</span></a></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="annot"><span class="hs-comment">-- | Edges are either halflines or Linesegments</span></span><span>
</span><span id="line-413"></span><span class="hs-keyword">type</span><span> </span><span id="EdgeGeometry"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeGeometry"><span class="hs-identifier hs-var">EdgeGeometry</span></a></span></span><span> </span><span id="local-6989586621679464251"><span class="annot"><a href="#local-6989586621679464251"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="annot"><a href="#local-6989586621679464251"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedLineSegment</span></span><span> </span><span class="annot"><a href="#local-6989586621679464251"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">-- | Get the projected geometries (halflines and edges line segments ) representing the</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- edges.</span><span>
</span><span id="line-417"></span><span id="local-6989586621679462931"><span id="local-6989586621679462932"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#projectedEdgeGeometries"><span class="hs-identifier hs-type">projectedEdgeGeometries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679462931"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462932"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462932"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679462932"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-418"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679462931"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679462932"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span>                           </span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Type.html#IndexedFold"><span class="hs-identifier hs-type">IndexedFold</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#EdgeIx"><span class="hs-identifier hs-type">EdgeIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462931"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462931"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeGeometry"><span class="hs-identifier hs-type">EdgeGeometry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462932"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-423"></span><span id="projectedEdgeGeometries"><span class="annot"><span class="annottext">projectedEdgeGeometries :: forall plane r.
(Plane_ plane r, Ord r, Fractional r, Show plane, Show r) =&gt;
IndexedFold
  (EdgeIx (LowerEnvelope' plane))
  (LowerEnvelope' plane)
  (EdgeGeometry (Point 2 r))
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#projectedEdgeGeometries"><span class="hs-identifier hs-var hs-var">projectedEdgeGeometries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LowerEnvelope' plane -&gt; [((Int, Int), EdgeGeometry (Point 2 r))])
-&gt; Over
     p
     f
     (LowerEnvelope' plane)
     (LowerEnvelope' plane)
     (EdgeGeometry (Point 2 r))
     (EdgeGeometry (Point 2 r))
forall (f :: * -&gt; *) i (p :: * -&gt; * -&gt; *) (g :: * -&gt; *) s a t b.
(Foldable f, Indexable i p, Contravariant g, Applicative g) =&gt;
(s -&gt; f (i, a)) -&gt; Over p g s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Fold.html#ifolding"><span class="hs-identifier hs-var">ifolding</span></a></span><span> </span><span class="annot"><span class="annottext">((LowerEnvelope' plane -&gt; [((Int, Int), EdgeGeometry (Point 2 r))])
 -&gt; Over
      p
      f
      (LowerEnvelope' plane)
      (LowerEnvelope' plane)
      (EdgeGeometry (Point 2 r))
      (EdgeGeometry (Point 2 r)))
-&gt; (LowerEnvelope' plane
    -&gt; [((Int, Int), EdgeGeometry (Point 2 r))])
-&gt; Over
     p
     f
     (LowerEnvelope' plane)
     (LowerEnvelope' plane)
     (EdgeGeometry (Point 2 r))
     (EdgeGeometry (Point 2 r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679464281"><span class="annot"><span class="annottext">LowerEnvelope' plane
</span><a href="#local-6989586621679464281"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679464282"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679464282"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679464283"><span class="annot"><span class="annottext">LEEdge plane
</span><a href="#local-6989586621679464283"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679464282"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LowerEnvelope' plane
-&gt; EdgeIx (LowerEnvelope' plane)
-&gt; Edge (LowerEnvelope' plane)
-&gt; EdgeGeometry (Point 2 r)
forall plane r.
(Plane_ plane r, Ord r, Fractional r, Show plane, Show r) =&gt;
LowerEnvelope' plane
-&gt; EdgeIx (LowerEnvelope' plane)
-&gt; Edge (LowerEnvelope' plane)
-&gt; EdgeGeometry (Point 2 r)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#projectedEdgeGeometry"><span class="hs-identifier hs-var">projectedEdgeGeometry</span></a></span><span> </span><span class="annot"><span class="annottext">LowerEnvelope' plane
</span><a href="#local-6989586621679464281"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
EdgeIx (LowerEnvelope' plane)
</span><a href="#local-6989586621679464282"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Edge (LowerEnvelope' plane)
LEEdge plane
</span><a href="#local-6989586621679464283"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int), LEEdge plane)
 -&gt; ((Int, Int), EdgeGeometry (Point 2 r)))
-&gt; [((Int, Int), LEEdge plane)]
-&gt; [((Int, Int), EdgeGeometry (Point 2 r))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LowerEnvelope' plane
</span><a href="#local-6989586621679464281"><span class="hs-identifier hs-var">env</span></a></span><span class="annot"><span class="annottext">LowerEnvelope' plane
-&gt; Getting
     (Endo [((Int, Int), LEEdge plane)])
     (LowerEnvelope' plane)
     ((Int, Int), LEEdge plane)
-&gt; [((Int, Int), LEEdge plane)]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">Indexed
  (Int, Int)
  (Edge (LowerEnvelope' plane))
  (Const
     (Endo [((Int, Int), LEEdge plane)]) (Edge (LowerEnvelope' plane)))
-&gt; LowerEnvelope' plane
-&gt; Const (Endo [((Int, Int), LEEdge plane)]) (LowerEnvelope' plane)
Indexed
  (Int, Int)
  (LEEdge plane)
  (Const (Endo [((Int, Int), LEEdge plane)]) (LEEdge plane))
-&gt; LowerEnvelope' plane
-&gt; Const (Endo [((Int, Int), LEEdge plane)]) (LowerEnvelope' plane)
forall graph graph'.
HasEdges graph graph' =&gt;
IndexedTraversal
  (EdgeIx graph) graph graph' (Edge graph) (Edge graph')
IndexedTraversal
  (EdgeIx (LowerEnvelope' plane))
  (LowerEnvelope' plane)
  (LowerEnvelope' plane)
  (Edge (LowerEnvelope' plane))
  (Edge (LowerEnvelope' plane))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#edges"><span class="hs-identifier hs-var">edges</span></a></span><span class="annot"><span class="annottext">(Indexed
   (Int, Int)
   (LEEdge plane)
   (Const (Endo [((Int, Int), LEEdge plane)]) (LEEdge plane))
 -&gt; LowerEnvelope' plane
 -&gt; Const
      (Endo [((Int, Int), LEEdge plane)]) (LowerEnvelope' plane))
-&gt; ((((Int, Int), LEEdge plane)
     -&gt; Const
          (Endo [((Int, Int), LEEdge plane)]) ((Int, Int), LEEdge plane))
    -&gt; Indexed
         (Int, Int)
         (LEEdge plane)
         (Const (Endo [((Int, Int), LEEdge plane)]) (LEEdge plane)))
-&gt; Getting
     (Endo [((Int, Int), LEEdge plane)])
     (LowerEnvelope' plane)
     ((Int, Int), LEEdge plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(((Int, Int), LEEdge plane)
 -&gt; Const
      (Endo [((Int, Int), LEEdge plane)]) ((Int, Int), LEEdge plane))
-&gt; Indexed
     (Int, Int)
     (LEEdge plane)
     (Const (Endo [((Int, Int), LEEdge plane)]) (LEEdge plane))
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s j t.
(Indexable i p, Functor f) =&gt;
p (i, s) (f (j, t)) -&gt; Indexed i s (f t)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Internal.Indexed.html#withIndex"><span class="hs-identifier hs-var">withIndex</span></a></span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-comment">-- TODO; this is kind of horrible, there must be a nicer way of writing this.</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="annot"><span class="hs-comment">-- | Computes the (projected) LineSegment or HalfLine representing a given edge.</span></span><span>
</span><span id="line-428"></span><span id="local-6989586621679462948"><span id="local-6989586621679462949"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#projectedEdgeGeometry"><span class="hs-identifier hs-type">projectedEdgeGeometry</span></a></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679462948"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462949"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679462949"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679462949"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-429"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679462948"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679462949"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-430"></span><span>                                       </span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>                                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462948"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-432"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#EdgeIx"><span class="hs-identifier hs-type">EdgeIx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462948"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#LowerEnvelope%27"><span class="hs-identifier hs-type">LowerEnvelope'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462948"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#EdgeGeometry"><span class="hs-identifier hs-type">EdgeGeometry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679462949"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-435"></span><span id="projectedEdgeGeometry"><span class="annot"><span class="annottext">projectedEdgeGeometry :: forall plane r.
(Plane_ plane r, Ord r, Fractional r, Show plane, Show r) =&gt;
LowerEnvelope' plane
-&gt; EdgeIx (LowerEnvelope' plane)
-&gt; Edge (LowerEnvelope' plane)
-&gt; EdgeGeometry (Point 2 r)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#projectedEdgeGeometry"><span class="hs-identifier hs-var hs-var">projectedEdgeGeometry</span></a></span></span><span> </span><span id="local-6989586621679464348"><span class="annot"><span class="annottext">LowerEnvelope' plane
</span><a href="#local-6989586621679464348"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464349"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464349"><span class="hs-identifier hs-var">ui</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679464350"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679464350"><span class="hs-identifier hs-var">vi</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464351"><span class="annot"><span class="annottext">Edge (LowerEnvelope' plane)
</span><a href="#local-6989586621679464351"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LowerEnvelope' plane
</span><a href="#local-6989586621679464348"><span class="hs-identifier hs-var">env</span></a></span><span class="annot"><span class="annottext">LowerEnvelope' plane
-&gt; Getting
     (Endo (Either (UnboundedVertex plane) (BoundedVertexF Seq plane)))
     (LowerEnvelope' plane)
     (Either (UnboundedVertex plane) (BoundedVertexF Seq plane))
-&gt; Either (UnboundedVertex plane) (BoundedVertexF Seq plane)
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Fold.html#%5E%3F%21"><span class="hs-operator hs-var">^?!</span></a></span><span class="annot"><span class="annottext">VertexIx (LowerEnvelope' plane)
-&gt; IndexedTraversal'
     (VertexIx (LowerEnvelope' plane))
     (LowerEnvelope' plane)
     (Vertex (LowerEnvelope' plane))
forall graph.
HasVertices' graph =&gt;
VertexIx graph
-&gt; IndexedTraversal' (VertexIx graph) graph (Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-var">vertexAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
VertexIx (LowerEnvelope' plane)
</span><a href="#local-6989586621679464349"><span class="hs-identifier hs-var">ui</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-436"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679464353"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464353"><span class="hs-identifier hs-var">_unboundedVtx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LowerEnvelope' plane
</span><a href="#local-6989586621679464348"><span class="hs-identifier hs-var">env</span></a></span><span class="annot"><span class="annottext">LowerEnvelope' plane
-&gt; Getting
     (Endo (Either (UnboundedVertex plane) (BoundedVertexF Seq plane)))
     (LowerEnvelope' plane)
     (Either (UnboundedVertex plane) (BoundedVertexF Seq plane))
-&gt; Either (UnboundedVertex plane) (BoundedVertexF Seq plane)
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Fold.html#%5E%3F%21"><span class="hs-operator hs-var">^?!</span></a></span><span class="annot"><span class="annottext">VertexIx (LowerEnvelope' plane)
-&gt; IndexedTraversal'
     (VertexIx (LowerEnvelope' plane))
     (LowerEnvelope' plane)
     (Vertex (LowerEnvelope' plane))
forall graph.
HasVertices' graph =&gt;
VertexIx graph
-&gt; IndexedTraversal' (VertexIx graph) graph (Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-var">vertexAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
VertexIx (LowerEnvelope' plane)
</span><a href="#local-6989586621679464350"><span class="hs-identifier hs-var">vi</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-437"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">UnboundedVertex plane
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; EdgeGeometry (Point 2 r)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;projectedEdgeGeometry: absurd edge from vInfty to vInfty&quot;</span></span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679464354"><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679464354"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BoundedVertexF Seq plane -&gt; EdgeGeometry (Point 2 r)
</span><a href="#local-6989586621679464355"><span class="hs-identifier hs-var">unboundedEdge</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679464354"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679464356"><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679464356"><span class="hs-identifier hs-var">u</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LowerEnvelope' plane
</span><a href="#local-6989586621679464348"><span class="hs-identifier hs-var">env</span></a></span><span class="annot"><span class="annottext">LowerEnvelope' plane
-&gt; Getting
     (Endo (Either (UnboundedVertex plane) (BoundedVertexF Seq plane)))
     (LowerEnvelope' plane)
     (Either (UnboundedVertex plane) (BoundedVertexF Seq plane))
-&gt; Either (UnboundedVertex plane) (BoundedVertexF Seq plane)
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Fold.html#%5E%3F%21"><span class="hs-operator hs-var">^?!</span></a></span><span class="annot"><span class="annottext">VertexIx (LowerEnvelope' plane)
-&gt; IndexedTraversal'
     (VertexIx (LowerEnvelope' plane))
     (LowerEnvelope' plane)
     (Vertex (LowerEnvelope' plane))
forall graph.
HasVertices' graph =&gt;
VertexIx graph
-&gt; IndexedTraversal' (VertexIx graph) graph (Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-var">vertexAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
VertexIx (LowerEnvelope' plane)
</span><a href="#local-6989586621679464350"><span class="hs-identifier hs-var">vi</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-440"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679464357"><span class="annot"><span class="annottext">UnboundedVertex plane
</span><a href="#local-6989586621679464357"><span class="hs-identifier hs-var">_unboundedVtx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BoundedVertexF Seq plane -&gt; EdgeGeometry (Point 2 r)
</span><a href="#local-6989586621679464355"><span class="hs-identifier hs-var">unboundedEdge</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679464356"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-441"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679464358"><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679464358"><span class="hs-identifier hs-var">v</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r) -&gt; EdgeGeometry (Point 2 r)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ClosedLineSegment (Point 2 r) -&gt; EdgeGeometry (Point 2 r))
-&gt; ClosedLineSegment (Point 2 r) -&gt; EdgeGeometry (Point 2 r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; ClosedLineSegment (Point 2 r)
forall point. point -&gt; point -&gt; ClosedLineSegment point
</span><span class="hs-identifier hs-var">ClosedLineSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679464356"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">BoundedVertexF Seq plane
-&gt; Getting (Point 2 r) (BoundedVertexF Seq plane) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) (BoundedVertexF Seq plane) (Point 2 r)
forall plane r (f :: * -&gt; *).
(NumType plane ~ r) =&gt;
Getter (BoundedVertexF f plane) (Point 2 r)
Getter (BoundedVertexF Seq plane) (Point 2 r)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#location2"><span class="hs-identifier hs-var">location2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679464358"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">BoundedVertexF Seq plane
-&gt; Getting (Point 2 r) (BoundedVertexF Seq plane) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) (BoundedVertexF Seq plane) (Point 2 r)
forall plane r (f :: * -&gt; *).
(NumType plane ~ r) =&gt;
Getter (BoundedVertexF f plane) (Point 2 r)
Getter (BoundedVertexF Seq plane) (Point 2 r)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#location2"><span class="hs-identifier hs-var">location2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-443"></span><span>    </span><span id="local-6989586621679464355"><span class="annot"><span class="annottext">unboundedEdge :: BoundedVertexF Seq plane -&gt; EdgeGeometry (Point 2 r)
</span><a href="#local-6989586621679464355"><span class="hs-identifier hs-var hs-var">unboundedEdge</span></a></span></span><span> </span><span id="local-6989586621679464360"><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679464360"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679464361"><span class="annot"><span class="annottext">dir :: Vector 2 r
</span><a href="#local-6989586621679464361"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LEEdge plane -&gt; LinePV 2 r
forall plane r.
(Plane_ plane r, Ord r, Fractional r) =&gt;
LEEdge plane -&gt; LinePV 2 r
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#edgeIntersectionLine"><span class="hs-identifier hs-var">edgeIntersectionLine</span></a></span><span> </span><span class="annot"><span class="annottext">Edge (LowerEnvelope' plane)
LEEdge plane
</span><a href="#local-6989586621679464351"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
-&gt; Getting (Vector 2 r) (LinePV 2 r) (Vector 2 r) -&gt; Vector 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Vector 2 r) (LinePV 2 r) (Vector 2 r)
forall (d :: Nat) r.
(Dimension (LinePV 2 r) ~ d, NumType (LinePV 2 r) ~ r) =&gt;
Lens' (LinePV 2 r) (Vector d r)
forall t (d :: Nat) r.
(HasDirection t, Dimension t ~ d, NumType t ~ r) =&gt;
Lens' t (Vector d r)
Lens' (LinePV 2 r) (Vector 2 r)
</span><span class="hs-identifier hs-var">direction</span></span><span class="annot"><span class="annottext">Getting (Vector 2 r) (LinePV 2 r) (Vector 2 r)
-&gt; ((Vector 2 r -&gt; Const (Vector 2 r) (Vector 2 r))
    -&gt; Vector 2 r -&gt; Const (Vector 2 r) (Vector 2 r))
-&gt; Getting (Vector 2 r) (LinePV 2 r) (Vector 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector 2 r -&gt; Vector 2 r)
-&gt; (Vector 2 r -&gt; Const (Vector 2 r) (Vector 2 r))
-&gt; Vector 2 r
-&gt; Const (Vector 2 r) (Vector 2 r)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
vector -&gt; vector
</span><span class="hs-identifier hs-var">negated</span></span><span>
</span><span id="line-444"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r) -&gt; EdgeGeometry (Point 2 r)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(HalfLine (Point 2 r) -&gt; EdgeGeometry (Point 2 r))
-&gt; HalfLine (Point 2 r) -&gt; EdgeGeometry (Point 2 r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
-&gt; Vector (Dimension (Point 2 r)) (NumType (Point 2 r))
-&gt; HalfLine (Point 2 r)
forall point.
point -&gt; Vector (Dimension point) (NumType point) -&gt; HalfLine point
</span><span class="hs-identifier hs-var">HalfLine</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedVertexF Seq plane
</span><a href="#local-6989586621679464360"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">BoundedVertexF Seq plane
-&gt; Getting (Point 2 r) (BoundedVertexF Seq plane) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) (BoundedVertexF Seq plane) (Point 2 r)
forall plane r (f :: * -&gt; *).
(NumType plane ~ r) =&gt;
Getter (BoundedVertexF f plane) (Point 2 r)
Getter (BoundedVertexF Seq plane) (Point 2 r)
</span><a href="HGeometry.Plane.LowerEnvelope.Type.html#location2"><span class="hs-identifier hs-var">location2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector (Dimension (Point 2 r)) (NumType (Point 2 r))
</span><a href="#local-6989586621679464361"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-comment">-- edge e is oriented from the lowerId towards the higherId, so in particular *from*</span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-comment">-- the unbounded vertex into the bounded vertex that means that to construct the</span><span>
</span><span id="line-447"></span><span>    </span><span class="hs-comment">-- halfline we actually wish to flip the orientation of the line</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-450"></span></pre></body></html>