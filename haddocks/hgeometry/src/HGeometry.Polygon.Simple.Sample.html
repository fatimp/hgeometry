<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  HGeometry.Polygon.Simple.Sample</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals, Owen Graves,  David Himmelstrup</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Functionality to sample points uniformly at random from within a simple polygon.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HGeometry.Polygon.Simple.Sample</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#samplePolygon"><span class="hs-identifier">samplePolygon</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#samplePolygons"><span class="hs-identifier">samplePolygons</span></a></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier">Sampler</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#samplePoint"><span class="hs-identifier">samplePoint</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#triangleSampler"><span class="hs-identifier">triangleSampler</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable1</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.PlaneGraph.html"><span class="hs-identifier">HGeometry.PlaneGraph</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.html"><span class="hs-identifier">HGeometry.Polygon</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Simple.Class.html"><span class="hs-identifier">HGeometry.Polygon.Simple.Class</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.html"><span class="hs-identifier">HGeometry.Polygon.Triangulation</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Triangle</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Vector</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Stateful.html"><span class="hs-identifier">System.Random.Stateful</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="annot"><span class="hs-comment">-- | A data structure that can be used to efficiently sample values of type v.</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">data</span><span> </span><span id="Sampler"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-var">Sampler</span></a></span></span><span> </span><span id="local-6989586621679513015"><span class="annot"><a href="#local-6989586621679513015"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679513016"><span class="annot"><a href="#local-6989586621679513016"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Sampler"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-var">Sampler</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679513015"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the total weight</span></span><span>
</span><span id="line-39"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679513015"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513016"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513361"><span id="local-6989586621679513368"><span id="local-6989586621679513372"><span class="annot"><span class="annottext">Int -&gt; Sampler w v -&gt; ShowS
[Sampler w v] -&gt; ShowS
Sampler w v -&gt; String
(Int -&gt; Sampler w v -&gt; ShowS)
-&gt; (Sampler w v -&gt; String)
-&gt; ([Sampler w v] -&gt; ShowS)
-&gt; Show (Sampler w v)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall w v. (Show w, Show v) =&gt; Int -&gt; Sampler w v -&gt; ShowS
forall w v. (Show w, Show v) =&gt; [Sampler w v] -&gt; ShowS
forall w v. (Show w, Show v) =&gt; Sampler w v -&gt; String
$cshowsPrec :: forall w v. (Show w, Show v) =&gt; Int -&gt; Sampler w v -&gt; ShowS
showsPrec :: Int -&gt; Sampler w v -&gt; ShowS
$cshow :: forall w v. (Show w, Show v) =&gt; Sampler w v -&gt; String
show :: Sampler w v -&gt; String
$cshowList :: forall w v. (Show w, Show v) =&gt; [Sampler w v] -&gt; ShowS
showList :: [Sampler w v] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679513379"><span id="local-6989586621679513383"><span id="local-6989586621679513386"><span id="local-6989586621679513396"><span class="annot"><span class="annottext">ReadPrec [Sampler w v]
ReadPrec (Sampler w v)
Int -&gt; ReadS (Sampler w v)
ReadS [Sampler w v]
(Int -&gt; ReadS (Sampler w v))
-&gt; ReadS [Sampler w v]
-&gt; ReadPrec (Sampler w v)
-&gt; ReadPrec [Sampler w v]
-&gt; Read (Sampler w v)
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
forall w v. (Ord w, Read w, Read v) =&gt; ReadPrec [Sampler w v]
forall w v. (Ord w, Read w, Read v) =&gt; ReadPrec (Sampler w v)
forall w v. (Ord w, Read w, Read v) =&gt; Int -&gt; ReadS (Sampler w v)
forall w v. (Ord w, Read w, Read v) =&gt; ReadS [Sampler w v]
$creadsPrec :: forall w v. (Ord w, Read w, Read v) =&gt; Int -&gt; ReadS (Sampler w v)
readsPrec :: Int -&gt; ReadS (Sampler w v)
$creadList :: forall w v. (Ord w, Read w, Read v) =&gt; ReadS [Sampler w v]
readList :: ReadS [Sampler w v]
$creadPrec :: forall w v. (Ord w, Read w, Read v) =&gt; ReadPrec (Sampler w v)
readPrec :: ReadPrec (Sampler w v)
$creadListPrec :: forall w v. (Ord w, Read w, Read v) =&gt; ReadPrec [Sampler w v]
readListPrec :: ReadPrec [Sampler w v]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679513402"><span id="local-6989586621679513407"><span class="annot"><span class="annottext">Sampler w v -&gt; Sampler w v -&gt; Bool
(Sampler w v -&gt; Sampler w v -&gt; Bool)
-&gt; (Sampler w v -&gt; Sampler w v -&gt; Bool) -&gt; Eq (Sampler w v)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall w v. (Eq w, Eq v) =&gt; Sampler w v -&gt; Sampler w v -&gt; Bool
$c== :: forall w v. (Eq w, Eq v) =&gt; Sampler w v -&gt; Sampler w v -&gt; Bool
== :: Sampler w v -&gt; Sampler w v -&gt; Bool
$c/= :: forall w v. (Eq w, Eq v) =&gt; Sampler w v -&gt; Sampler w v -&gt; Bool
/= :: Sampler w v -&gt; Sampler w v -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679513412"><span id="local-6989586621679513416"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Sampler w a -&gt; Sampler w b)
-&gt; (forall a b. a -&gt; Sampler w b -&gt; Sampler w a)
-&gt; Functor (Sampler w)
forall a b. a -&gt; Sampler w b -&gt; Sampler w a
forall a b. (a -&gt; b) -&gt; Sampler w a -&gt; Sampler w b
forall w a b. a -&gt; Sampler w b -&gt; Sampler w a
forall w a b. (a -&gt; b) -&gt; Sampler w a -&gt; Sampler w b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall w a b. (a -&gt; b) -&gt; Sampler w a -&gt; Sampler w b
fmap :: forall a b. (a -&gt; b) -&gt; Sampler w a -&gt; Sampler w b
$c&lt;$ :: forall w a b. a -&gt; Sampler w b -&gt; Sampler w a
&lt;$ :: forall a b. a -&gt; Sampler w b -&gt; Sampler w a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679513421"><span id="local-6989586621679513427"><span id="local-6989586621679513433"><span id="local-6989586621679513438"><span id="local-6989586621679513441"><span id="local-6989586621679513444"><span id="local-6989586621679513447"><span id="local-6989586621679513450"><span id="local-6989586621679513453"><span id="local-6989586621679513456"><span id="local-6989586621679513459"><span id="local-6989586621679513462"><span id="local-6989586621679513465"><span id="local-6989586621679513470"><span id="local-6989586621679513475"><span id="local-6989586621679513480"><span id="local-6989586621679513485"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; Sampler w m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Sampler w a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Sampler w a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Sampler w a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Sampler w a -&gt; a)
-&gt; (forall a. Sampler w a -&gt; [a])
-&gt; (forall a. Sampler w a -&gt; Bool)
-&gt; (forall a. Sampler w a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; Sampler w a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; Sampler w a -&gt; a)
-&gt; (forall a. Ord a =&gt; Sampler w a -&gt; a)
-&gt; (forall a. Num a =&gt; Sampler w a -&gt; a)
-&gt; (forall a. Num a =&gt; Sampler w a -&gt; a)
-&gt; Foldable (Sampler w)
forall a. Eq a =&gt; a -&gt; Sampler w a -&gt; Bool
forall a. Num a =&gt; Sampler w a -&gt; a
forall a. Ord a =&gt; Sampler w a -&gt; a
forall m. Monoid m =&gt; Sampler w m -&gt; m
forall a. Sampler w a -&gt; Bool
forall a. Sampler w a -&gt; Int
forall a. Sampler w a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; Sampler w a -&gt; a
forall w a. Eq a =&gt; a -&gt; Sampler w a -&gt; Bool
forall w a. Num a =&gt; Sampler w a -&gt; a
forall w a. Ord a =&gt; Sampler w a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Sampler w a -&gt; m
forall w m. Monoid m =&gt; Sampler w m -&gt; m
forall w a. Sampler w a -&gt; Bool
forall w a. Sampler w a -&gt; Int
forall w a. Sampler w a -&gt; [a]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
forall w a. (a -&gt; a -&gt; a) -&gt; Sampler w a -&gt; a
forall w m a. Monoid m =&gt; (a -&gt; m) -&gt; Sampler w a -&gt; m
forall w b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
forall w a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall w m. Monoid m =&gt; Sampler w m -&gt; m
fold :: forall m. Monoid m =&gt; Sampler w m -&gt; m
$cfoldMap :: forall w m a. Monoid m =&gt; (a -&gt; m) -&gt; Sampler w a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Sampler w a -&gt; m
$cfoldMap' :: forall w m a. Monoid m =&gt; (a -&gt; m) -&gt; Sampler w a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Sampler w a -&gt; m
$cfoldr :: forall w a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
$cfoldr' :: forall w a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
$cfoldl :: forall w b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
$cfoldl' :: forall w b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Sampler w a -&gt; b
$cfoldr1 :: forall w a. (a -&gt; a -&gt; a) -&gt; Sampler w a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Sampler w a -&gt; a
$cfoldl1 :: forall w a. (a -&gt; a -&gt; a) -&gt; Sampler w a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Sampler w a -&gt; a
$ctoList :: forall w a. Sampler w a -&gt; [a]
toList :: forall a. Sampler w a -&gt; [a]
$cnull :: forall w a. Sampler w a -&gt; Bool
null :: forall a. Sampler w a -&gt; Bool
$clength :: forall w a. Sampler w a -&gt; Int
length :: forall a. Sampler w a -&gt; Int
$celem :: forall w a. Eq a =&gt; a -&gt; Sampler w a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; Sampler w a -&gt; Bool
$cmaximum :: forall w a. Ord a =&gt; Sampler w a -&gt; a
maximum :: forall a. Ord a =&gt; Sampler w a -&gt; a
$cminimum :: forall w a. Ord a =&gt; Sampler w a -&gt; a
minimum :: forall a. Ord a =&gt; Sampler w a -&gt; a
$csum :: forall w a. Num a =&gt; Sampler w a -&gt; a
sum :: forall a. Num a =&gt; Sampler w a -&gt; a
$cproduct :: forall w a. Num a =&gt; Sampler w a -&gt; a
product :: forall a. Num a =&gt; Sampler w a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679513009"><span id="local-6989586621679513496"><span id="local-6989586621679513502"><span id="local-6989586621679513507"><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-type">Sampler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513009"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679513519"><span class="annot"><span class="annottext">traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Sampler w a -&gt; f (Sampler w b)
</span><a href="#local-6989586621679513519"><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></a></span></span><span> </span><span id="local-6989586621679513521"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679513521"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-type">Sampler</span></a></span><span> </span><span id="local-6989586621679513522"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679513522"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679513523"><span class="annot"><span class="annottext">Map w a
</span><a href="#local-6989586621679513523"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">w -&gt; Map w b -&gt; Sampler w b
forall w v. w -&gt; Map w v -&gt; Sampler w v
</span><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-var">Sampler</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679513522"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Map w b -&gt; Sampler w b) -&gt; f (Map w b) -&gt; f (Sampler w b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Map w a -&gt; f (Map w b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Map w a -&gt; f (Map w b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679513521"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Map w a
</span><a href="#local-6989586621679513523"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | Build a sampler</span><span>
</span><span id="line-46"></span><span class="hs-comment">--</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- O(n)</span><span>
</span><span id="line-48"></span><span id="local-6989586621679513020"><span id="local-6989586621679513022"><span id="local-6989586621679513023"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#buildSampler"><span class="hs-identifier hs-type">buildSampler</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679513020"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679513022"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679513022"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513020"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679513022"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679513023"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-type">Sampler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513022"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513023"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-49"></span><span id="buildSampler"><span class="annot"><span class="annottext">buildSampler :: forall (nonEmpty :: * -&gt; *) w v.
(Foldable1 nonEmpty, Num w, Ord w) =&gt;
nonEmpty (w, v) -&gt; Sampler w v
</span><a href="HGeometry.Polygon.Simple.Sample.html#buildSampler"><span class="hs-identifier hs-var hs-var">buildSampler</span></a></span></span><span> </span><span id="local-6989586621679513537"><span class="annot"><span class="annottext">nonEmpty (w, v)
</span><a href="#local-6989586621679513537"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Weighted"><span class="hs-identifier hs-type">Weighted</span></a></span><span> </span><span id="local-6989586621679513539"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679513539"><span class="hs-identifier hs-var">total</span></a></span></span><span> </span><span id="local-6989586621679513540"><span class="annot"><span class="annottext">[(w, v)]
</span><a href="#local-6989586621679513540"><span class="hs-identifier hs-var">xs'</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((w, v) -&gt; Weighted w [(w, v)] -&gt; Weighted w [(w, v)])
-&gt; Weighted w [(w, v)] -&gt; nonEmpty (w, v) -&gt; Weighted w [(w, v)]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; nonEmpty a -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(w, v) -&gt; Weighted w [(w, v)] -&gt; Weighted w [(w, v)]
forall {a} {b}.
Num a =&gt;
(a, b) -&gt; Weighted a [(a, b)] -&gt; Weighted a [(a, b)]
</span><a href="#local-6989586621679513542"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w -&gt; [(w, v)] -&gt; Weighted w [(w, v)]
forall w v. w -&gt; v -&gt; Weighted w v
</span><a href="HGeometry.Polygon.Simple.Sample.html#Weighted"><span class="hs-identifier hs-var">Weighted</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">nonEmpty (w, v)
</span><a href="#local-6989586621679513537"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-50"></span><span>                      </span><span id="local-6989586621679513542"><span class="annot"><span class="annottext">f :: (a, b) -&gt; Weighted a [(a, b)] -&gt; Weighted a [(a, b)]
</span><a href="#local-6989586621679513542"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513545"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513545"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679513546"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679513546"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Weighted"><span class="hs-identifier hs-type">Weighted</span></a></span><span> </span><span id="local-6989586621679513547"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513547"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679513548"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679513548"><span class="hs-identifier hs-var">acc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [(a, b)] -&gt; Weighted a [(a, b)]
forall w v. w -&gt; v -&gt; Weighted w v
</span><a href="HGeometry.Polygon.Simple.Sample.html#Weighted"><span class="hs-identifier hs-var">Weighted</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513545"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513547"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679513547"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679513546"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679513548"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">w -&gt; Map w v -&gt; Sampler w v
forall w v. w -&gt; Map w v -&gt; Sampler w v
</span><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-var">Sampler</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679513539"><span class="hs-identifier hs-var">total</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(w, v)] -&gt; Map w v
forall k a. Eq k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromDescList</span></span><span> </span><span class="annot"><span class="annottext">[(w, v)]
</span><a href="#local-6989586621679513540"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><span class="hs-comment">-- | Helper data type</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">data</span><span> </span><span id="Weighted"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Weighted"><span class="hs-identifier hs-var">Weighted</span></a></span></span><span> </span><span id="local-6989586621679513032"><span class="annot"><a href="#local-6989586621679513032"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679513033"><span class="annot"><a href="#local-6989586621679513033"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Weighted"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Weighted"><span class="hs-identifier hs-var">Weighted</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679513032"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513033"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679513554"><span id="local-6989586621679513559"><span id="local-6989586621679513563"><span class="annot"><span class="annottext">Int -&gt; Weighted w v -&gt; ShowS
[Weighted w v] -&gt; ShowS
Weighted w v -&gt; String
(Int -&gt; Weighted w v -&gt; ShowS)
-&gt; (Weighted w v -&gt; String)
-&gt; ([Weighted w v] -&gt; ShowS)
-&gt; Show (Weighted w v)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall w v. (Show w, Show v) =&gt; Int -&gt; Weighted w v -&gt; ShowS
forall w v. (Show w, Show v) =&gt; [Weighted w v] -&gt; ShowS
forall w v. (Show w, Show v) =&gt; Weighted w v -&gt; String
$cshowsPrec :: forall w v. (Show w, Show v) =&gt; Int -&gt; Weighted w v -&gt; ShowS
showsPrec :: Int -&gt; Weighted w v -&gt; ShowS
$cshow :: forall w v. (Show w, Show v) =&gt; Weighted w v -&gt; String
show :: Weighted w v -&gt; String
$cshowList :: forall w v. (Show w, Show v) =&gt; [Weighted w v] -&gt; ShowS
showList :: [Weighted w v] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | Sample a value from the sampler</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- \(O(\log n)\)</span><span>
</span><span id="line-59"></span><span id="local-6989586621679513042"><span id="local-6989586621679513043"><span id="local-6989586621679513045"><span id="local-6989586621679513047"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#sample"><span class="hs-identifier hs-type">sample</span></a></span><span>                     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#StatefulGen"><span class="hs-identifier hs-type">StatefulGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513042"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513043"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679513045"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679513045"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#UniformRange"><span class="hs-identifier hs-type">UniformRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513045"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>                           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-type">Sampler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513045"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513047"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513042"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513043"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513047"><span class="hs-identifier hs-type">v</span></a></span></span></span></span></span><span>
</span><span id="line-61"></span><span id="sample"><span class="annot"><span class="annottext">sample :: forall g (m :: * -&gt; *) w v.
(StatefulGen g m, Ord w, Num w, UniformRange w) =&gt;
Sampler w v -&gt; g -&gt; m v
</span><a href="HGeometry.Polygon.Simple.Sample.html#sample"><span class="hs-identifier hs-var hs-var">sample</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-type">Sampler</span></a></span><span> </span><span id="local-6989586621679513580"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679513580"><span class="hs-identifier hs-var">total</span></a></span></span><span> </span><span id="local-6989586621679513581"><span class="annot"><span class="annottext">Map w v
</span><a href="#local-6989586621679513581"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679513582"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679513582"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; ((w, v) -&gt; v) -&gt; Maybe (w, v) -&gt; v
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">v
forall {a}. a
</span><a href="#local-6989586621679513584"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(w, v) -&gt; v
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (w, v) -&gt; v) -&gt; (w -&gt; Maybe (w, v)) -&gt; w -&gt; v
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(w -&gt; Map w v -&gt; Maybe (w, v)) -&gt; Map w v -&gt; w -&gt; Maybe (w, v)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">w -&gt; Map w v -&gt; Maybe (w, v)
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Maybe (k, v)
</span><span class="hs-identifier hs-var">Map.lookupLE</span></span><span> </span><span class="annot"><span class="annottext">Map w v
</span><a href="#local-6989586621679513581"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(w -&gt; v) -&gt; m w -&gt; m v
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(w, w) -&gt; g -&gt; m w
forall a g (m :: * -&gt; *).
(UniformRange a, StatefulGen g m) =&gt;
(a, a) -&gt; g -&gt; m a
forall g (m :: * -&gt; *). StatefulGen g m =&gt; (w, w) -&gt; g -&gt; m w
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#uniformRM"><span class="hs-identifier hs-var">uniformRM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679513580"><span class="hs-identifier hs-var">total</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679513582"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679513584"><span class="annot"><span class="annottext">err :: a
</span><a href="#local-6989586621679513584"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sample: absurd.&quot;</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Build a triangle sampler; i.e. samples a triagnle from the polygons</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- with probability proportional to its area.</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- \(O(N\log N\), where \(N\) is the total size of all polygons.</span><span>
</span><span id="line-72"></span><span id="local-6989586621679513074"><span id="local-6989586621679513075"><span id="local-6989586621679513076"><span id="local-6989586621679513078"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#triangleSampler"><span class="hs-identifier hs-type">triangleSampler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.Class.html#SimplePolygon_"><span class="hs-identifier hs-type">SimplePolygon_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513074"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513075"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513076"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679513076"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679513076"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679513078"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513078"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513074"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-type">Sampler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513076"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679513075"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-74"></span><span id="triangleSampler"><span class="annot"><span class="annottext">triangleSampler :: forall polygon point r (nonEmpty :: * -&gt; *).
(SimplePolygon_ polygon point r, Num r, Ord r,
 Foldable1 nonEmpty) =&gt;
nonEmpty polygon -&gt; Sampler r (Triangle point)
</span><a href="HGeometry.Polygon.Simple.Sample.html#triangleSampler"><span class="hs-identifier hs-var hs-var">triangleSampler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty (r, Triangle point) -&gt; Sampler r (Triangle point)
forall (nonEmpty :: * -&gt; *) w v.
(Foldable1 nonEmpty, Num w, Ord w) =&gt;
nonEmpty (w, v) -&gt; Sampler w v
</span><a href="HGeometry.Polygon.Simple.Sample.html#buildSampler"><span class="hs-identifier hs-var">buildSampler</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (r, Triangle point) -&gt; Sampler r (Triangle point))
-&gt; (nonEmpty polygon -&gt; NonEmpty (r, Triangle point))
-&gt; nonEmpty polygon
-&gt; Sampler r (Triangle point)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Triangle point -&gt; (r, Triangle point))
-&gt; NonEmpty (Triangle point) -&gt; NonEmpty (r, Triangle point)
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679513803"><span class="annot"><span class="annottext">Triangle point
</span><a href="#local-6989586621679513803"><span class="hs-identifier hs-var">tri</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Triangle point -&gt; r
forall r point triangle.
(Num r, Point_ point 2 r, Triangle_ triangle point) =&gt;
triangle -&gt; r
</span><span class="hs-identifier hs-var">triangleSignedArea2X</span></span><span> </span><span class="annot"><span class="annottext">Triangle point
</span><a href="#local-6989586621679513803"><span class="hs-identifier hs-var">tri</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Triangle point
</span><a href="#local-6989586621679513803"><span class="hs-identifier hs-var">tri</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>                </span><span class="annot"><span class="annottext">(NonEmpty (Triangle point) -&gt; NonEmpty (r, Triangle point))
-&gt; (nonEmpty polygon -&gt; NonEmpty (Triangle point))
-&gt; nonEmpty polygon
-&gt; NonEmpty (r, Triangle point)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(polygon -&gt; NonEmpty (Triangle point))
-&gt; nonEmpty polygon -&gt; NonEmpty (Triangle point)
forall m a. Semigroup m =&gt; (a -&gt; m) -&gt; nonEmpty a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable1 t, Semigroup m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap1</span></span><span> </span><span class="annot"><span class="annottext">polygon -&gt; NonEmpty (Triangle point)
forall polygon point r.
(SimplePolygon_ polygon point r, Num r, Ord r) =&gt;
polygon -&gt; NonEmpty (Triangle point)
</span><a href="HGeometry.Polygon.Simple.Sample.html#toTriangles"><span class="hs-identifier hs-var">toTriangles</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- | Sample a point</span></span><span>
</span><span id="line-78"></span><span id="local-6989586621679513162"><span id="local-6989586621679513163"><span id="local-6989586621679513164"><span id="local-6989586621679513165"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#samplePoint"><span class="hs-identifier hs-type">samplePoint</span></a></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679513162"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679513163"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#StatefulGen"><span class="hs-identifier hs-type">StatefulGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513164"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513165"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679513163"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679513163"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#UniformRange"><span class="hs-identifier hs-type">UniformRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513163"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#Sampler"><span class="hs-identifier hs-type">Sampler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513163"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679513162"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513164"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513165"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-80"></span><span id="samplePoint"><span class="annot"><span class="annottext">samplePoint :: forall point r g (m :: * -&gt; *).
(Point_ point 2 r, StatefulGen g m, Real r, Ord r,
 UniformRange r) =&gt;
Sampler r (Triangle point) -&gt; g -&gt; m (Point 2 Double)
</span><a href="HGeometry.Polygon.Simple.Sample.html#samplePoint"><span class="hs-identifier hs-var hs-var">samplePoint</span></a></span></span><span> </span><span id="local-6989586621679513880"><span class="annot"><span class="annottext">Sampler r (Triangle point)
</span><a href="#local-6989586621679513880"><span class="hs-identifier hs-var">sampler</span></a></span></span><span> </span><span id="local-6989586621679513881"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679513881"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sampler r (Triangle point) -&gt; g -&gt; m (Triangle point)
forall g (m :: * -&gt; *) w v.
(StatefulGen g m, Ord w, Num w, UniformRange w) =&gt;
Sampler w v -&gt; g -&gt; m v
</span><a href="HGeometry.Polygon.Simple.Sample.html#sample"><span class="hs-identifier hs-var">sample</span></a></span><span> </span><span class="annot"><span class="annottext">Sampler r (Triangle point)
</span><a href="#local-6989586621679513880"><span class="hs-identifier hs-var">sampler</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679513881"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">m (Triangle point)
-&gt; (Triangle point -&gt; m (Point 2 Double)) -&gt; m (Point 2 Double)
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Triangle point -&gt; g -&gt; m (Point 2 Double))
-&gt; g -&gt; Triangle point -&gt; m (Point 2 Double)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Triangle point -&gt; g -&gt; m (Point 2 Double)
forall point r g (m :: * -&gt; *).
(Point_ point 2 r, Real r, StatefulGen g m) =&gt;
Triangle point -&gt; g -&gt; m (Point 2 Double)
</span><a href="HGeometry.Polygon.Simple.Sample.html#sampleTriangle"><span class="hs-identifier hs-var">sampleTriangle</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679513881"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | Unfiormly samples a point from a set of polygons. You may want to build a</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- pointSampler if the goal is to sample multiple points.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- \(O(N\log N\), where \(N\) is the total size of all polygons.</span><span>
</span><span id="line-86"></span><span id="local-6989586621679513178"><span id="local-6989586621679513179"><span id="local-6989586621679513180"><span id="local-6989586621679513181"><span id="local-6989586621679513182"><span id="local-6989586621679513183"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#samplePolygons"><span class="hs-identifier hs-type">samplePolygons</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Class.html#SimplePolygon_"><span class="hs-identifier hs-type">SimplePolygon_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513178"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513179"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513180"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#StatefulGen"><span class="hs-identifier hs-type">StatefulGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513181"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513182"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-87"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679513183"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679513180"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679513180"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#UniformRange"><span class="hs-identifier hs-type">UniformRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513180"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-88"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513183"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513178"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513181"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513182"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-90"></span><span id="samplePolygons"><span class="annot"><span class="annottext">samplePolygons :: forall polygon point r g (m :: * -&gt; *) (nonEmpty :: * -&gt; *).
(SimplePolygon_ polygon point r, StatefulGen g m,
 Foldable1 nonEmpty, Real r, Ord r, UniformRange r) =&gt;
nonEmpty polygon -&gt; g -&gt; m (Point 2 Double)
</span><a href="HGeometry.Polygon.Simple.Sample.html#samplePolygons"><span class="hs-identifier hs-var hs-var">samplePolygons</span></a></span></span><span> </span><span id="local-6989586621679514097"><span class="annot"><span class="annottext">nonEmpty polygon
</span><a href="#local-6989586621679514097"><span class="hs-identifier hs-var">pgs</span></a></span></span><span> </span><span id="local-6989586621679514098"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679514098"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Sampler r (Triangle point) -&gt; g -&gt; m (Point 2 Double))
-&gt; g -&gt; Sampler r (Triangle point) -&gt; m (Point 2 Double)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Sampler r (Triangle point) -&gt; g -&gt; m (Point 2 Double)
forall point r g (m :: * -&gt; *).
(Point_ point 2 r, StatefulGen g m, Real r, Ord r,
 UniformRange r) =&gt;
Sampler r (Triangle point) -&gt; g -&gt; m (Point 2 Double)
</span><a href="HGeometry.Polygon.Simple.Sample.html#samplePoint"><span class="hs-identifier hs-var">samplePoint</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679514098"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">(Sampler r (Triangle point) -&gt; m (Point 2 Double))
-&gt; Sampler r (Triangle point) -&gt; m (Point 2 Double)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">nonEmpty polygon -&gt; Sampler r (Triangle point)
forall polygon point r (nonEmpty :: * -&gt; *).
(SimplePolygon_ polygon point r, Num r, Ord r,
 Foldable1 nonEmpty) =&gt;
nonEmpty polygon -&gt; Sampler r (Triangle point)
</span><a href="HGeometry.Polygon.Simple.Sample.html#triangleSampler"><span class="hs-identifier hs-var">triangleSampler</span></a></span><span> </span><span class="annot"><span class="annottext">nonEmpty polygon
</span><a href="#local-6989586621679514097"><span class="hs-identifier hs-var">pgs</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | Uniformly samples a point in a polygon.</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- \(O(n\log n )\)</span><span>
</span><span id="line-95"></span><span id="local-6989586621679513193"><span id="local-6989586621679513194"><span id="local-6989586621679513195"><span id="local-6989586621679513196"><span id="local-6989586621679513197"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#samplePolygon"><span class="hs-identifier hs-type">samplePolygon</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Class.html#SimplePolygon_"><span class="hs-identifier hs-type">SimplePolygon_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513193"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513194"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513195"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679513195"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679513195"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#UniformRange"><span class="hs-identifier hs-type">UniformRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513195"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-96"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#StatefulGen"><span class="hs-identifier hs-type">StatefulGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513196"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513197"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513193"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513196"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513197"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-98"></span><span id="samplePolygon"><span class="annot"><span class="annottext">samplePolygon :: forall polygon point r g (m :: * -&gt; *).
(SimplePolygon_ polygon point r, Ord r, Real r, UniformRange r,
 StatefulGen g m) =&gt;
polygon -&gt; g -&gt; m (Point 2 Double)
</span><a href="HGeometry.Polygon.Simple.Sample.html#samplePolygon"><span class="hs-identifier hs-var hs-var">samplePolygon</span></a></span></span><span> </span><span id="local-6989586621679514276"><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679514276"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty polygon -&gt; g -&gt; m (Point 2 Double)
forall polygon point r g (m :: * -&gt; *) (nonEmpty :: * -&gt; *).
(SimplePolygon_ polygon point r, StatefulGen g m,
 Foldable1 nonEmpty, Real r, Ord r, UniformRange r) =&gt;
nonEmpty polygon -&gt; g -&gt; m (Point 2 Double)
</span><a href="HGeometry.Polygon.Simple.Sample.html#samplePolygons"><span class="hs-identifier hs-var">samplePolygons</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty polygon -&gt; g -&gt; m (Point 2 Double))
-&gt; NonEmpty polygon -&gt; g -&gt; m (Point 2 Double)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679514276"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">polygon -&gt; [polygon] -&gt; NonEmpty polygon
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NonEmpty.:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><span class="hs-comment">-- | Uniformly samples a triangle in \(O(1)\) time.</span></span><span>
</span><span id="line-101"></span><span id="local-6989586621679513174"><span id="local-6989586621679513175"><span id="local-6989586621679513176"><span id="local-6989586621679513177"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#sampleTriangle"><span class="hs-identifier hs-type">sampleTriangle</span></a></span><span>                                       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679513174"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679513175"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679513175"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-102"></span><span>                                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#StatefulGen"><span class="hs-identifier hs-type">StatefulGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513176"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513177"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>                                                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679513174"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513176"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513177"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-104"></span><span id="sampleTriangle"><span class="annot"><span class="annottext">sampleTriangle :: forall point r g (m :: * -&gt; *).
(Point_ point 2 r, Real r, StatefulGen g m) =&gt;
Triangle point -&gt; g -&gt; m (Point 2 Double)
</span><a href="HGeometry.Polygon.Simple.Sample.html#sampleTriangle"><span class="hs-identifier hs-var hs-var">sampleTriangle</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(point -&gt; Point 2 Double)
-&gt; Triangle point -&gt; Triangle (Point 2 Double)
forall a b. (a -&gt; b) -&gt; Triangle a -&gt; Triangle b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">point -&gt; Point 2 Double
forall point r.
(Point_ point 2 r, Real r) =&gt;
point -&gt; Point 2 Double
</span><a href="HGeometry.Polygon.Simple.Sample.html#doubleP"><span class="hs-identifier hs-var">doubleP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span id="local-6989586621679514455"><span class="annot"><span class="annottext">Point 2 Double
</span><a href="#local-6989586621679514455"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679514456"><span class="annot"><span class="annottext">Point 2 Double
</span><a href="#local-6989586621679514456"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span id="local-6989586621679514457"><span class="annot"><span class="annottext">Point 2 Double
</span><a href="#local-6989586621679514457"><span class="hs-identifier hs-var">v3</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679514458"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679514458"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point 2 Double
</span><a href="#local-6989586621679514459"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Point 2 Double)
-&gt; m Double -&gt; m (Double -&gt; Point 2 Double)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; g -&gt; m Double
forall a g (m :: * -&gt; *).
(UniformRange a, StatefulGen g m) =&gt;
(a, a) -&gt; g -&gt; m a
forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
(Double, Double) -&gt; g -&gt; m Double
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#uniformRM"><span class="hs-identifier hs-var">uniformRM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679514458"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">m (Double -&gt; Point 2 Double) -&gt; m Double -&gt; m (Point 2 Double)
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; g -&gt; m Double
forall a g (m :: * -&gt; *).
(UniformRange a, StatefulGen g m) =&gt;
(a, a) -&gt; g -&gt; m a
forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
(Double, Double) -&gt; g -&gt; m Double
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/random-1.2.1.2-f4cff084f5bb381e8d0ea5f0ff70ce7cde0fcd9c12ea6754a93ba014da9eb283/share/doc/html/src/System.Random.Internal.html#uniformRM"><span class="hs-identifier hs-var">uniformRM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679514458"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="#local-6989586621679514459"><span class="hs-identifier hs-type">f</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-108"></span><span>    </span><span id="local-6989586621679514459"><span class="annot"><span class="annottext">f :: Double -&gt; Double -&gt; Point 2 Double
</span><a href="#local-6989586621679514459"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679514460"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514460"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621679514461"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514461"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679514462"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514462"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679514463"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514463"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514460"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514461"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514460"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514461"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514460"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514461"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>                  </span><span id="local-6989586621679514465"><span class="annot"><span class="annottext">u :: Vector 2 Double
</span><a href="#local-6989586621679514465"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 Double
</span><a href="#local-6989586621679514456"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 Double -&gt; Point 2 Double -&gt; Vector 2 Double
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; point -&gt; Vector d r
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">Point 2 Double
</span><a href="#local-6989586621679514455"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-110"></span><span>                  </span><span id="local-6989586621679514467"><span class="annot"><span class="annottext">v :: Vector 2 Double
</span><a href="#local-6989586621679514467"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 Double
</span><a href="#local-6989586621679514457"><span class="hs-identifier hs-var">v3</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 Double -&gt; Point 2 Double -&gt; Vector 2 Double
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; point -&gt; Vector d r
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">Point 2 Double
</span><a href="#local-6989586621679514455"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-111"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Point 2 Double
</span><a href="#local-6989586621679514455"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 Double -&gt; Vector 2 Double -&gt; Point 2 Double
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514462"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Double -&gt; Vector 2 Double -&gt; Vector 2 Double
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
r -&gt; vector -&gt; vector
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Vector 2 Double
</span><a href="#local-6989586621679514465"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point 2 Double -&gt; Vector 2 Double -&gt; Point 2 Double
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679514463"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Double -&gt; Vector 2 Double -&gt; Vector 2 Double
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
r -&gt; vector -&gt; vector
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Vector 2 Double
</span><a href="#local-6989586621679514467"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- the idea is based on</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- https://blogs.sas.com/content/iml/2020/10/19/random-points-in-triangle.html</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><span class="hs-comment">-- | Convert to a point with double coordiantes</span></span><span>
</span><span id="line-116"></span><span id="local-6989586621679513219"><span id="local-6989586621679513220"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#doubleP"><span class="hs-identifier hs-type">doubleP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679513219"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679513220"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679513220"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513219"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-117"></span><span id="doubleP"><span class="annot"><span class="annottext">doubleP :: forall point r.
(Point_ point 2 r, Real r) =&gt;
point -&gt; Point 2 Double
</span><a href="HGeometry.Polygon.Simple.Sample.html#doubleP"><span class="hs-identifier hs-var hs-var">doubleP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter (Point 2 r) (Point 2 Double) (NumType (Point 2 r)) Double
-&gt; (NumType (Point 2 r) -&gt; Double) -&gt; Point 2 r -&gt; Point 2 Double
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Setter.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">ASetter (Point 2 r) (Point 2 Double) (NumType (Point 2 r)) Double
(NumType (Point 2 r) -&gt; Identity (NumType (Point 2 Double)))
-&gt; Point 2 r -&gt; Identity (Point 2 Double)
forall point point'.
HasCoordinates point point' =&gt;
IndexedTraversal1 Int point point' (NumType point) (NumType point')
IndexedTraversal1
  Int
  (Point 2 r)
  (Point 2 Double)
  (NumType (Point 2 r))
  (NumType (Point 2 Double))
</span><span class="hs-identifier hs-var">coordinates</span></span><span> </span><span class="annot"><span class="annottext">NumType (Point 2 r) -&gt; Double
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Point 2 Double)
-&gt; (point -&gt; Point 2 r) -&gt; point -&gt; Point 2 Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r) -&gt; point -&gt; Point 2 r
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="annot"><span class="hs-comment">-- | Triangulates a polygon \(O(n \log n)\).</span></span><span>
</span><span id="line-120"></span><span id="local-6989586621679513159"><span id="local-6989586621679513160"><span id="local-6989586621679513161"><span class="annot"><a href="HGeometry.Polygon.Simple.Sample.html#toTriangles"><span class="hs-identifier hs-type">toTriangles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.Class.html#SimplePolygon_"><span class="hs-identifier hs-type">SimplePolygon_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513159"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513160"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679513161"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679513161"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679513161"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679513159"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679513160"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-122"></span><span id="toTriangles"><span class="annot"><span class="annottext">toTriangles :: forall polygon point r.
(SimplePolygon_ polygon point r, Num r, Ord r) =&gt;
polygon -&gt; NonEmpty (Triangle point)
</span><a href="HGeometry.Polygon.Simple.Sample.html#toTriangles"><span class="hs-identifier hs-var hs-var">toTriangles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triangle point] -&gt; NonEmpty (Triangle point)
forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Triangle point] -&gt; NonEmpty (Triangle point))
-&gt; (polygon -&gt; [Triangle point])
-&gt; polygon
-&gt; NonEmpty (Triangle point)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Triangle (point :+ VertexId ()) -&gt; Triangle point)
-&gt; [Triangle (point :+ VertexId ())] -&gt; [Triangle point]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((point :+ VertexId ()) -&gt; point)
-&gt; Triangle (point :+ VertexId ()) -&gt; Triangle point
forall a b. (a -&gt; b) -&gt; Triangle a -&gt; Triangle b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting point (point :+ VertexId ()) point
-&gt; (point :+ VertexId ()) -&gt; point
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting point (point :+ VertexId ()) point
forall core extra core' (f :: * -&gt; *).
Functor f =&gt;
(core -&gt; f core') -&gt; (core :+ extra) -&gt; f (core' :+ extra)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#core"><span class="hs-identifier hs-var">core</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>            </span><span class="annot"><span class="annottext">([Triangle (point :+ VertexId ())] -&gt; [Triangle point])
-&gt; (polygon -&gt; [Triangle (point :+ VertexId ())])
-&gt; polygon
-&gt; [Triangle point]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SimplePolygon (point :+ VertexId ())
 -&gt; Maybe (Triangle (point :+ VertexId ())))
-&gt; [SimplePolygon (point :+ VertexId ())]
-&gt; [Triangle (point :+ VertexId ())]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon (point :+ VertexId ())
-&gt; Maybe (Triangle (point :+ VertexId ()))
forall polygon point r.
Polygon_ polygon point r =&gt;
polygon -&gt; Maybe (Triangle point)
</span><a href="HGeometry.Polygon.html#asTriangle"><span class="hs-identifier hs-var">asTriangle</span></a></span><span> </span><span class="annot"><span class="annottext">([SimplePolygon (point :+ VertexId ())]
 -&gt; [Triangle (point :+ VertexId ())])
-&gt; (polygon -&gt; [SimplePolygon (point :+ VertexId ())])
-&gt; polygon
-&gt; [Triangle (point :+ VertexId ())]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Endo [SimplePolygon (point :+ VertexId ())])
  (PlaneGraph () point PolygonEdgeType PolygonFaceData)
  (SimplePolygon (point :+ VertexId ()))
-&gt; PlaneGraph () point PolygonEdgeType PolygonFaceData
-&gt; [SimplePolygon (point :+ VertexId ())]
forall a s. Getting (Endo [a]) s a -&gt; s -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.3.2-6eec07dfa16b863ab004b7c8ae8536ba6a793ca92f6ae40f2a5eb6f8b181d7a9/share/doc/html/src/Control.Lens.Fold.html#toListOf"><span class="hs-identifier hs-var">toListOf</span></a></span><span> </span><span class="annot"><span class="annottext">(SimplePolygon
   (point
    :+ VertexIx (PlaneGraph () point PolygonEdgeType PolygonFaceData))
 -&gt; Const
      (Endo [SimplePolygon (point :+ VertexId ())])
      (SimplePolygon
         (point
          :+ VertexIx
               (PlaneGraph () point PolygonEdgeType PolygonFaceData))))
-&gt; PlaneGraph () point PolygonEdgeType PolygonFaceData
-&gt; Const
     (Endo [SimplePolygon (point :+ VertexId ())])
     (PlaneGraph () point PolygonEdgeType PolygonFaceData)
Getting
  (Endo [SimplePolygon (point :+ VertexId ())])
  (PlaneGraph () point PolygonEdgeType PolygonFaceData)
  (SimplePolygon (point :+ VertexId ()))
forall planeGraph vertex r.
(PlaneGraph_ planeGraph vertex, Point_ vertex 2 r, Ord r, Num r,
 Eq (FaceIx planeGraph)) =&gt;
IndexedFold
  (FaceIx planeGraph)
  planeGraph
  (SimplePolygon (vertex :+ VertexIx planeGraph))
IndexedFold
  (FaceIx (PlaneGraph () point PolygonEdgeType PolygonFaceData))
  (PlaneGraph () point PolygonEdgeType PolygonFaceData)
  (SimplePolygon
     (point
      :+ VertexIx (PlaneGraph () point PolygonEdgeType PolygonFaceData)))
</span><a href="HGeometry.PlaneGraph.Class.html#interiorFacePolygons"><span class="hs-identifier hs-var">interiorFacePolygons</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaneGraph () point PolygonEdgeType PolygonFaceData
 -&gt; [SimplePolygon (point :+ VertexId ())])
-&gt; (polygon -&gt; PlaneGraph () point PolygonEdgeType PolygonFaceData)
-&gt; polygon
-&gt; [SimplePolygon (point :+ VertexId ())]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {k} (s :: k) polygon point r.
(SimplePolygon_ polygon point r, Ord r, Num r) =&gt;
polygon -&gt; PlaneGraph s point PolygonEdgeType PolygonFaceData
forall s polygon point r.
(SimplePolygon_ polygon point r, Ord r, Num r) =&gt;
polygon -&gt; PlaneGraph s point PolygonEdgeType PolygonFaceData
</span><a href="HGeometry.Polygon.Triangulation.html#triangulate"><span class="hs-identifier hs-var">triangulate</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-comment">-- any valid simple polygon produces at least one triangle, so the</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-comment">-- NonEmpty.fromList is safe.</span><span>
</span><span id="line-126"></span></pre></body></html>